Going to start with configuration Configuration: name:  =========== Running TLS Validator ============   mempool size: 2047 core cache: 32 primary core: 1
 Ports:
	Port 0000:01:00.1 RXQ_Count: 1 RX_Queues: [ 3 ] TXQ_Count: 1 TX_Queues: 3 RXD: 128 TXD: 128 Loopback false
	Port 0000:01:00.0 RXQ_Count: 1 RX_Queues: [ 2 ] TXQ_Count: 1 TX_Queues: 2 RXD: 128 TXD: 128 Loopback false
Cores:
	2
	3
	4
	5
	6
	7
	8
	9
	10
	11

EAL: Probing VFIO support...
Running on node 0
Devname: "0000:01:00.1"
EAL: PCI device 0000:01:00.1 on NUMA socket -1
EAL:   Invalid NUMA socket, default to 0
EAL:   probe driver: 8086:1583 net_i40e
Going to try and use port 0
Devname: "0000:01:00.0"
EAL: PCI device 0000:01:00.0 on NUMA socket -1
EAL:   Invalid NUMA socket, default to 0
EAL:   probe driver: 8086:1583 net_i40e
Going to try and use port 1
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Receiving port f8:f2:1e:2e:9c:50 rxq 0 txq 0
Receiving port f8:f2:1e:2e:9c:51 rxq 0 txq 0
Running 1 pipelines
Running 0 pipelines
Running 0 pipelines
Running 0 pipelines
Running on node 0
Running 0 pipelines
Running 1 pipelines
Running 0 pipelines
Running 0 pipelines
Running 0 pipelines
Starting scheduler on 2
Running 0 pipelines
Starting scheduler on 3
Starting scheduler on 7
Starting scheduler on 9
Starting scheduler on 8
Starting scheduler on 4
Starting scheduler on 11
Starting scheduler on 10
Starting scheduler on 6
Starting scheduler on 5
0 OVERALL RX 0.00 TX 0.00 CYCLE_PER_DELAY 0 0 0

Pkt #598259529 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598259573 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #598259681 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #598260409 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598261105 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598261149 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598261193 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598261237 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598261281 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598261325 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1926922463 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

Pkt #598261369 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2684247636 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }

Pkt #1926922464 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

Pkt #1926922464 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("expired.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 292 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 292
      4: This packet is inserted, quack

Pkt #2684247637 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }

Pkt #2684247637 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #2684249045 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2684250453 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2684251861 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 526
Inserted
reading size of 526 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 526
Passing because is not Client Key Exchange

Pkt #1926922756 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1926922756 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1926922756 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1926922756 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1926922756 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }
Matching server name
Result is Some(DNSName("expired.badssl.com"))
ServerName is: Some(DNSName("expired.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("expired.badssl.com")

DEBUG: 
Oops, error: invalid certificate: CertExpired
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }


Pkt #2684252387 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1926922882 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1926922882 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 177
Inserted
reading size of 177 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 177
Passing because is not Client Key Exchange

Pkt #598261413 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #598261521 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #598262329 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2684252645 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #1926923059 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1926923059 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1059884498 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

Pkt #2684253415 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56360, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1926923060 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56360, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1106567661 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }

Pkt #1059884499 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

Pkt #1059884499 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("wrong.host.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 295 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 295
      4: This packet is inserted, quack

Pkt #1106567662 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }

Pkt #1106567662 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1106569070 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1059884794 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1106570478 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #1059884794 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1059884794 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1059884794 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }
Matching server name
Result is Some(DNSName("wrong.host.badssl.com"))
ServerName is: Some(DNSName("wrong.host.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("wrong.host.badssl.com")

DEBUG: 
Oops, error: invalid certificate: CertNotValidForName
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }


Pkt #598262953 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1106571098 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1059884920 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1059884920 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 180
Inserted
reading size of 180 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 180
Passing because is not Client Key Exchange

Pkt #1106571372 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #1059885100 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1059885100 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2778122453 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }

Pkt #1106572148 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56361, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1059885101 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56361, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #571894688 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 }

Pkt #2778122454 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }

Pkt #2778122454 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("self-signed.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 296 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 296
      4: This packet is inserted, quack

Pkt #598262997 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #571894689 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 }

Pkt #571894689 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1330 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1330
      4: This packet is inserted, quack

Pkt #2778122750 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2778122750 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2778122750 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }
Matching server name
Result is Some(DNSName("self-signed.badssl.com"))
ServerName is: Some(DNSName("self-signed.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("self-signed.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 }


Pkt #571896019 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #2778122876 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #2778122876 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 181
Inserted
reading size of 181 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 181
Passing because is not Client Key Exchange

Pkt #571896293 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #2778123057 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2778123057 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3178501138 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }

Pkt #571897071 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56362, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2778123058 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56362, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598263041 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #555537762 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }

Pkt #3178501139 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }

Pkt #3178501139 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("untrusted-root.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 299 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 299
      4: This packet is inserted, quack

Pkt #555537763 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }

Pkt #555537763 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #555539171 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 210
Inserted
reading size of 210 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 210
Passing because is not Client Key Exchange

Pkt #3178501438 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3178501438 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 3178501438 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }
Matching server name
Result is Some(DNSName("untrusted-root.badssl.com"))
ServerName is: Some(DNSName("untrusted-root.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("untrusted-root.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }


Pkt #555539381 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #3178501564 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #3178501564 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 184
Inserted
reading size of 184 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 184
Passing because is not Client Key Exchange

Pkt #555539655 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #3178501748 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3178501748 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598263085 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1647475990 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }

Pkt #555540531 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56363, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3178501749 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56363, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1685256085 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 }

Pkt #1647475991 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }

Pkt #1647475991 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("superfish.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 294 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 294
      4: This packet is inserted, quack

Pkt #1685256086 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 }

Pkt #1685256086 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1198 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1198
      4: This packet is inserted, quack

Pkt #1647476285 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1647476285 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1647476285 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }
Matching server name
Result is Some(DNSName("superfish.badssl.com"))
ServerName is: Some(DNSName("superfish.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("superfish.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 }


Pkt #1685257284 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1647476411 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1647476411 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 179
Inserted
reading size of 179 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 179
Passing because is not Client Key Exchange

Pkt #598263129 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1685257542 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #1647476590 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1647476590 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3617208484 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }

Pkt #1685258316 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56364, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1647476591 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56364, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #885757083 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 }

Pkt #3617208485 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }

Pkt #3617208485 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("edellroot.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 294 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 294
      4: This packet is inserted, quack

Pkt #885757084 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 }

Pkt #885757084 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1256 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1256
      4: This packet is inserted, quack

Pkt #598263173 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #3617208779 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3617208779 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 3617208779 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }
Matching server name
Result is Some(DNSName("edellroot.badssl.com"))
ServerName is: Some(DNSName("edellroot.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("edellroot.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 }


Pkt #885758340 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #3617208905 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #3617208905 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 179
Inserted
reading size of 179 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 179
Passing because is not Client Key Exchange

Pkt #885758598 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #3617209084 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3617209084 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1946291388 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }

Pkt #885759372 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56365, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3617209085 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56365, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598263217 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1909636192 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }

Pkt #1946291389 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }

Pkt #1946291389 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("dsdtestprovider.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 300 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 300
      4: This packet is inserted, quack

Pkt #1909636193 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }

Pkt #1909636193 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1909637601 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 174
Inserted
reading size of 174 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 174
Passing because is not Client Key Exchange

Pkt #1946291689 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1946291689 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1946291689 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }
Matching server name
Result is Some(DNSName("dsdtestprovider.badssl.com"))
ServerName is: Some(DNSName("dsdtestprovider.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("dsdtestprovider.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }


Pkt #1909637775 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1946291815 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1946291815 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 185
Inserted
reading size of 185 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 185
Passing because is not Client Key Exchange

Pkt #1909638049 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #1946292000 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1946292000 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598263261 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598263369 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598264161 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3209205214 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }

Pkt #1909638835 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56366, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1946292001 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56366, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1010578587 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 }

Pkt #3209205215 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }

Pkt #3209205215 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("preact-cli.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 295 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 295
      4: This packet is inserted, quack

Pkt #1010578588 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 }

Pkt #1010578588 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1256 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1256
      4: This packet is inserted, quack

Pkt #3209205510 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3209205510 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 3209205510 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }
Matching server name
Result is Some(DNSName("preact-cli.badssl.com"))
ServerName is: Some(DNSName("preact-cli.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("preact-cli.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 }


Pkt #1010579844 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #3209205636 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #3209205636 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 180
Inserted
reading size of 180 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 180
Passing because is not Client Key Exchange

Pkt #598264801 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1010580118 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #3209205816 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3209205816 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2894872370 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }

Pkt #1010580894 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56367, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3209205817 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56367, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #408372423 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 }

Pkt #2894872371 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }

Pkt #2894872371 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("webpack-dev-server.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 303 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 303
      4: This packet is inserted, quack

Pkt #408372424 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 }

Pkt #408372424 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1274 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1274
      4: This packet is inserted, quack

Pkt #2894872674 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2894872674 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2894872674 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }
Matching server name
Result is Some(DNSName("webpack-dev-server.badssl.com"))
ServerName is: Some(DNSName("webpack-dev-server.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("webpack-dev-server.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 }


Pkt #598264845 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #408373698 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #2894872800 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #2894872800 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 188
Inserted
reading size of 188 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 188
Passing because is not Client Key Exchange

Pkt #408373972 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #2894872988 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2894872988 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2960309791 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

Pkt #408374763 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56368, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2894872989 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56368, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #4205810384 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }

Pkt #2960309792 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

Pkt #2960309792 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("sha1-intermediate.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 302 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 302
      4: This packet is inserted, quack

Pkt #598264889 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #4205810385 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }

Pkt #4205810385 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #4205811793 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #4205813201 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 147
Inserted
reading size of 147 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 147
Passing because is not Client Key Exchange

Pkt #2960310094 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2960310094 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2960310094 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2960310094 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }
Matching server name
Result is Some(DNSName("sha1-intermediate.badssl.com"))
ServerName is: Some(DNSName("sha1-intermediate.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("sha1-intermediate.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }


Pkt #4205813348 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #2960310220 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #2960310220 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 187
Inserted
reading size of 187 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 187
Passing because is not Client Key Exchange

Pkt #4205813622 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #2960310407 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2960310407 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1513918019 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56370, proto: 6 }

Pkt #4205814512 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56369, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2960310408 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56369, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598264933 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #867444686 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56370, dst_port: 443, proto: 6 }

Pkt #1513918020 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56370, proto: 6 }

Pkt #1513918020 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56370, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("rc4.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 288 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56370, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 288
      4: This packet is inserted, quack

Pkt #867444687 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56370, dst_port: 443, proto: 6 }

Pkt #867444687 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56370, dst_port: 443, proto: 6 }

Pkt #867444694 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56370, dst_port: 443, proto: 6 }

Pkt #1513918308 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56370, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1513918308 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56370, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1513918308 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56370, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1516714001 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56371, proto: 6 }

Pkt #867444695 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56370, dst_port: 443, proto: 6 }

Pkt #4228794393 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56371, dst_port: 443, proto: 6 }

Pkt #1516714002 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56371, proto: 6 }

Pkt #1516714002 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56371, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("rc4-md5.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 292 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56371, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 292
      4: This packet is inserted, quack

Pkt #598264977 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #4228794394 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56371, dst_port: 443, proto: 6 }

Pkt #4228794394 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56371, dst_port: 443, proto: 6 }

Pkt #4228794401 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56371, dst_port: 443, proto: 6 }

Pkt #1516714294 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56371, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1516714294 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56371, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1516714294 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56371, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3430595465 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 }

Pkt #4228794402 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56371, dst_port: 443, proto: 6 }

Pkt #1065714840 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 }

Pkt #3430595466 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 }

Pkt #3430595466 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("dh480.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 290 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 290
      4: This packet is inserted, quack

Pkt #1065714841 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 }

Pkt #1065714841 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1065716249 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1065717657 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 670
Inserted
reading size of 670 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56372, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 670
Passing because is not Client Key Exchange

Pkt #3430595756 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3430595756 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3430595756 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 7
Inserted
reading size of 7 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 7
Passing because is not Client Key Exchange

Pkt #3430595763 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 6
Inserted
reading size of 6 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56372, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 6
Passing because is not Client Key Exchange

Pkt #598265021 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1704410002 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 }

Pkt #1089935028 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 }

Pkt #1704410003 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 }

Pkt #1704410003 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("dh512.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 290 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 290
      4: This packet is inserted, quack

Pkt #1089935029 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 }

Pkt #1089935029 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1089936437 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1089937845 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 678
Inserted
reading size of 678 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56373, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 678
Passing because is not Client Key Exchange

Pkt #1704410293 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1704410293 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1704410293 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 7
Inserted
reading size of 7 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 7
Passing because is not Client Key Exchange

Pkt #1704410300 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 6
Inserted
reading size of 6 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56373, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 6
Passing because is not Client Key Exchange

Pkt #402605048 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

Pkt #598265065 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #939656765 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }

Pkt #402605049 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

Pkt #402605049 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("dh1024.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 291 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 291
      4: This packet is inserted, quack

Pkt #939656766 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }

Pkt #939656766 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #939658174 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #939659582 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 806
Inserted
reading size of 806 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 806
Passing because is not Client Key Exchange

Pkt #402605340 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #402605340 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #402605340 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 190
Inserted
reading size of 190 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 190

important: Pkt 402605340 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }
Matching server name
Result is Some(DNSName("dh1024.badssl.com"))
ServerName is: Some(DNSName("dh1024.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 67

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("dh1024.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #939660388 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #402605530 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #402605530 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 176
Inserted
reading size of 176 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 176
Passing because is not Client Key Exchange

Pkt #939660646 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 869
Inserted
reading size of 869 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 869
Passing because is not Client Key Exchange

Pkt #402605706 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598265109 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598265217 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #598265937 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #402605706 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2019758871 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56375, proto: 6 }

Pkt #939661515 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56374, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #402605707 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56374, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1810979689 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56375, dst_port: 443, proto: 6 }

Pkt #2019758872 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56375, proto: 6 }

Pkt #2019758872 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56375, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("null.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 289 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56375, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 289
      4: This packet is inserted, quack

Pkt #1810979690 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56375, dst_port: 443, proto: 6 }

Pkt #1810979690 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56375, dst_port: 443, proto: 6 }

Pkt #1810979697 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56375, dst_port: 443, proto: 6 }

Pkt #2019759161 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56375, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2019759161 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56375, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2019759161 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56375, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2769168747 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

Pkt #1810979698 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56375, dst_port: 443, proto: 6 }

Pkt #598266641 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1915876316 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }

Pkt #2769168748 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

Pkt #2769168748 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("tls-v1-0.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 293 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 293
      4: This packet is inserted, quack

Pkt #1915876317 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }

Pkt #1915876317 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1915877725 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1915879133 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #2769169041 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2769169041 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2769169041 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2769169041 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }
Matching server name
Result is Some(DNSName("tls-v1-0.badssl.com"))
ServerName is: Some(DNSName("tls-v1-0.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("tls-v1-0.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #1915879753 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #2769169167 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2769169167 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 178
Inserted
reading size of 178 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 178
Passing because is not Client Key Exchange

Pkt #598266685 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1915880011 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 440
Inserted
reading size of 440 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 440
Passing because is not Client Key Exchange

Pkt #2769169345 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1880477359 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

Pkt #460835292 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }

Pkt #1880477360 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

Pkt #1880477360 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("tls-v1-0.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 293 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 293
      4: This packet is inserted, quack

Pkt #460835293 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }

Pkt #460835293 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #460836701 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #460838109 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 618
Inserted
reading size of 618 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 618
Passing because is not Client Key Exchange

Pkt #1880477653 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1880477653 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1880477653 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 134
Inserted
reading size of 134 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 134

important: Pkt 1880477653 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }
Matching server name
Result is Some(DNSName("tls-v1-0.badssl.com"))
ServerName is: Some(DNSName("tls-v1-0.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("tls-v1-0.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #460838727 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 266
Inserted
reading size of 266 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 266
Passing because is not Client Key Exchange

Pkt #1880477787 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1880477787 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 218
Inserted
reading size of 218 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 218
Passing because is not Client Key Exchange

Pkt #598266729 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #460838993 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 773
Inserted
reading size of 773 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 773
Passing because is not Client Key Exchange

Pkt #1880478005 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2769169345 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 31
Inserted
reading size of 31 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 31
Passing because is not Client Key Exchange

Pkt #2769169376 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1880478005 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #350009195 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

Pkt #1915880451 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56376, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2769169377 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56376, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #460839766 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56377, dst_port: 1010, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1880478006 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1010, dst_port: 56377, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3002833424 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }

Pkt #350009196 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

Pkt #350009196 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("tls-v1-1.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 293 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 293
      4: This packet is inserted, quack

Pkt #3002833425 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }

Pkt #3002833425 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #3002834833 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3002836241 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #350009489 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #350009489 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #350009489 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 350009489 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }
Matching server name
Result is Some(DNSName("tls-v1-1.badssl.com"))
ServerName is: Some(DNSName("tls-v1-1.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("tls-v1-1.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #598266773 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3002836861 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #350009615 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #350009615 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 178
Inserted
reading size of 178 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 178
Passing because is not Client Key Exchange

Pkt #3002837119 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 440
Inserted
reading size of 440 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 440
Passing because is not Client Key Exchange

Pkt #350009793 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3962518490 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

Pkt #1133412233 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }

Pkt #3962518491 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

Pkt #3962518491 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("tls-v1-1.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 293 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 293
      4: This packet is inserted, quack

Pkt #1133412234 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }

Pkt #1133412234 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1133413642 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3962518784 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1133415050 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 618
Inserted
reading size of 618 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 618
Passing because is not Client Key Exchange

Pkt #3962518784 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3962518784 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 150
Inserted
reading size of 150 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 150

important: Pkt 3962518784 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }
Matching server name
Result is Some(DNSName("tls-v1-1.badssl.com"))
ServerName is: Some(DNSName("tls-v1-1.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("tls-v1-1.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #598266817 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1133415668 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 282
Inserted
reading size of 282 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 282
Passing because is not Client Key Exchange

Pkt #3962518934 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3962518934 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 197
Inserted
reading size of 197 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 197
Passing because is not Client Key Exchange

Pkt #1133415950 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 789
Inserted
reading size of 789 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 789
Passing because is not Client Key Exchange

Pkt #3962519131 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #350009793 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 31
Inserted
reading size of 31 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 31
Passing because is not Client Key Exchange

Pkt #350009824 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3962519131 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2029765977 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

Pkt #3002837559 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56378, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #350009825 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56378, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1133416739 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56379, dst_port: 1011, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3962519132 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1011, dst_port: 56379, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #228406374 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }

Pkt #2029765978 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

Pkt #2029765978 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("cbc.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 288 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 288
      4: This packet is inserted, quack

Pkt #598266861 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #228406375 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }

Pkt #228406375 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #228407783 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #228409191 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #2029766266 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2029766266 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2029766266 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 182
Inserted
reading size of 182 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 182

important: Pkt 2029766266 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }
Matching server name
Result is Some(DNSName("cbc.badssl.com"))
ServerName is: Some(DNSName("cbc.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("cbc.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #228409811 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 314
Inserted
reading size of 314 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 314
Passing because is not Client Key Exchange

Pkt #2029766448 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2029766448 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 229
Inserted
reading size of 229 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 229
Passing because is not Client Key Exchange

Pkt #228410125 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 805
Inserted
reading size of 805 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 805
Passing because is not Client Key Exchange

Pkt #2029766677 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2029766677 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3488624141 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56381, proto: 6 }

Pkt #598266905 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #228410930 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56380, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2029766678 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56380, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #4187919959 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56381, dst_port: 443, proto: 6 }

Pkt #3488624142 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56381, proto: 6 }

Pkt #3488624142 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56381, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("3des.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 289 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56381, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 289
      4: This packet is inserted, quack

Pkt #4187919960 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56381, dst_port: 443, proto: 6 }

Pkt #4187919960 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56381, dst_port: 443, proto: 6 }

Pkt #4187919967 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56381, dst_port: 443, proto: 6 }

Pkt #3488624431 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56381, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3488624431 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56381, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3488624431 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56381, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1835998487 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

Pkt #4187919968 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56381, dst_port: 443, proto: 6 }

Pkt #167367843 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }

Pkt #1835998488 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

Pkt #1835998488 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("revoked.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 292 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 292
      4: This packet is inserted, quack

Pkt #598266949 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598267057 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598267689 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #167367844 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }

Pkt #167367844 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #167369252 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #167370660 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 501
Inserted
reading size of 501 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 501
Passing because is not Client Key Exchange

Pkt #1835998780 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1835998780 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1835998780 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1835998780 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }
Matching server name
Result is Some(DNSName("revoked.badssl.com"))
ServerName is: Some(DNSName("revoked.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("revoked.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #167371161 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #1835998906 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1835998906 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 177
Inserted
reading size of 177 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 177
Passing because is not Client Key Exchange

Pkt #167371419 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 851
Inserted
reading size of 851 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 851
Passing because is not Client Key Exchange

Pkt #1835999083 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1835999083 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598268517 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3078149480 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

Pkt #167372270 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56382, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1835999084 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56382, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1244171602 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }

Pkt #3078149481 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

Pkt #3078149481 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("pinning-test.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 297 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 297
      4: This packet is inserted, quack

Pkt #1244171603 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }

Pkt #1244171603 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1244173011 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1244174419 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #3078149778 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3078149778 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3078149778 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 3078149778 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }
Matching server name
Result is Some(DNSName("pinning-test.badssl.com"))
ServerName is: Some(DNSName("pinning-test.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("pinning-test.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #1244175039 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 274
Inserted
reading size of 274 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 274
Passing because is not Client Key Exchange

Pkt #3078149904 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3078149904 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 182
Inserted
reading size of 182 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 182
Passing because is not Client Key Exchange

Pkt #598268561 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1244175313 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 849
Inserted
reading size of 849 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 849
Passing because is not Client Key Exchange

Pkt #3078150086 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3078150086 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1681202057 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

Pkt #1244176162 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56383, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3078150087 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56383, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3466748864 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }

Pkt #1681202058 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

Pkt #1681202058 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("invalid-expected-sct.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 305 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 305
      4: This packet is inserted, quack

Pkt #3466748865 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }

Pkt #3466748865 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #3466750273 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3466751681 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 37
Inserted
reading size of 37 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 37
Passing because is not Client Key Exchange

Pkt #1681202363 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1681202363 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1681202363 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1681202363 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }
Matching server name
Result is Some(DNSName("invalid-expected-sct.badssl.com"))
ServerName is: Some(DNSName("invalid-expected-sct.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("invalid-expected-sct.badssl.com")

DEBUG: 
Oops, error: invalid certificate: CertExpired
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }


Pkt #598268605 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3466751718 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1681202489 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #1681202489 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 190
Inserted
reading size of 190 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 190
Passing because is not Client Key Exchange

Pkt #3466751992 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #1681202679 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1681202679 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653433 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

Pkt #3466753040 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56384, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1681202680 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56384, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1864787152 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

Pkt #530653434 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

Pkt #530653434 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("1000-sans.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 294 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 294
      4: This packet is inserted, quack

Pkt #598268649 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1864787153 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

Pkt #1864787153 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1864788561 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1864789969 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864791377 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1864792785 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864794193 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864795601 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864797009 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864798417 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864799825 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1864801233 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864802641 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864804049 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864805457 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864806865 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864808273 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864809681 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864811089 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864812497 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864813905 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864815313 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864816721 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864818129 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1864819537 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 347
Inserted
reading size of 347 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 347
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653728 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 530653728 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }
Matching server name
Result is Some(DNSName("1000-sans.badssl.com"))
ServerName is: Some(DNSName("1000-sans.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Get None, abort

DEBUG: We now retrieve the certs from the tcp payload

error: CertificateNotExtractedError

Pkt #1864819884 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #530653854 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530653854 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 179
Inserted
reading size of 179 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 179
Passing because is not Client Key Exchange

Pkt #1864820142 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 912
Inserted
reading size of 912 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 912
Passing because is not Client Key Exchange

Pkt #530654033 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530654033 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598268693 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2254918315 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

Pkt #1864821054 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56385, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #530654034 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56385, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297511501 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

Pkt #2254918316 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

Pkt #2254918316 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("10000-sans.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 295 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 295
      4: This packet is inserted, quack

Pkt #2297511502 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

Pkt #2297511502 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #2297512910 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297514318 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297515726 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297517134 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297518542 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297519950 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297521358 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297522766 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297524174 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297525582 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297526990 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297528398 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297529806 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297531214 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297532622 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297534030 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297535438 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297536846 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297538254 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297539662 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297541070 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297542478 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297543886 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297545294 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297546702 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297548110 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297549518 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297550926 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297552334 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 7
Inserted
reading size of 7 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 7
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 6
Inserted
reading size of 6 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 6
Passing because is not Client Key Exchange

Pkt #598268737 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #4269515823 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56387, proto: 6 }

Pkt #2297553742 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297555150 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297556558 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297557966 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297559374 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297560782 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297562190 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297563598 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297565006 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918611 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297566414 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297567822 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2297569230 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297570638 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297572046 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297573454 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297574862 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297576270 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297577678 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297579086 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297580494 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297581902 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297583310 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297584718 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2297586126 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56386, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2254918618 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56386, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3885443531 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56388, proto: 6 }

Pkt #2239237117 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56388, dst_port: 443, proto: 6 }

Pkt #3885443707 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56388, proto: 6 }

Pkt #3885443707 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56388, proto: 6 }

Pkt #126309801 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

Pkt #2239237891 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56388, dst_port: 443, proto: 6 }

Pkt #3885443708 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56388, proto: 6 }

Pkt #598270373 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2415685782 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }

Pkt #126309802 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

Pkt #126309802 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("rsa8192.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 292 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 292
      4: This packet is inserted, quack

Pkt #2415685783 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }

Pkt #2415685783 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #2415687191 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #126310094 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2415688599 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2415690007 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 750
Inserted
reading size of 750 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 750
Passing because is not Client Key Exchange

Pkt #126310094 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #126310094 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #126310094 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 126310094 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }
Matching server name
Result is Some(DNSName("rsa8192.badssl.com"))
ServerName is: Some(DNSName("rsa8192.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("rsa8192.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #598270417 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2415690757 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2415690757 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #126310220 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #126310220 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 177
Inserted
reading size of 177 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 177
Passing because is not Client Key Exchange

Pkt #2415691015 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 1116
Inserted
reading size of 1116 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1116
Passing because is not Client Key Exchange

Pkt #126310397 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #126310397 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3311545439 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

Pkt #2415692131 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56389, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #126310398 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56389, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3923414111 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }

Pkt #3311545440 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

Pkt #3311545440 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("no-subject.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 295 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 295
      4: This packet is inserted, quack

Pkt #598270461 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3923414112 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }

Pkt #3923414112 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #3923415520 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3923416928 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3923418336 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 809
Inserted
reading size of 809 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 809
Passing because is not Client Key Exchange

Pkt #3311545735 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3311545735 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3311545735 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3311545735 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 3311545735 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }
Matching server name
Result is Some(DNSName("no-subject.badssl.com"))
ServerName is: Some(DNSName("no-subject.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("no-subject.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #3923419145 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 274
Inserted
reading size of 274 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 274
Passing because is not Client Key Exchange

Pkt #3311545861 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3311545861 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 180
Inserted
reading size of 180 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 180
Passing because is not Client Key Exchange

Pkt #3923419419 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 855
Inserted
reading size of 855 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 855
Passing because is not Client Key Exchange

Pkt #3311546041 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3311546041 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3628712246 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

Pkt #3923420274 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56390, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3311546042 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56390, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598270505 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2118081866 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }

Pkt #3628712247 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

Pkt #3628712247 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("no-common-name.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 299 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 299
      4: This packet is inserted, quack

Pkt #2118081867 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }

Pkt #2118081867 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #2118083275 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3628712546 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2118084683 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2118086091 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 570
Inserted
reading size of 570 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 570
Passing because is not Client Key Exchange

Pkt #3628712546 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3628712546 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3628712546 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 3628712546 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }
Matching server name
Result is Some(DNSName("no-common-name.badssl.com"))
ServerName is: Some(DNSName("no-common-name.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("no-common-name.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #2118086661 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 274
Inserted
reading size of 274 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 274
Passing because is not Client Key Exchange

Pkt #3628712672 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3628712672 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 184
Inserted
reading size of 184 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 184
Passing because is not Client Key Exchange

Pkt #2118086935 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 842
Inserted
reading size of 842 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 842
Passing because is not Client Key Exchange

Pkt #3628712856 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3628712856 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598270549 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #346675404 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }

Pkt #2118087777 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56391, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3628712857 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56391, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1955118685 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }

Pkt #346675405 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }

Pkt #346675405 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("incomplete-chain.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 301 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 301
      4: This packet is inserted, quack

Pkt #1955118686 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }

Pkt #1955118686 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1955120094 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 849
Inserted
reading size of 849 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 849
Passing because is not Client Key Exchange

Pkt #346675706 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #346675706 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 346675706 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }
Matching server name
Result is Some(DNSName("incomplete-chain.badssl.com"))
ServerName is: Some(DNSName("incomplete-chain.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("incomplete-chain.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
Result of the cert validation is false

Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }


Pkt #1955120943 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #346675832 belong to a unsafe flow!

Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 } is marked as unsafe connection so we have to reset


Pkt #346675832 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 186
Inserted
reading size of 186 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 186
Passing because is not Client Key Exchange

Pkt #598270593 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1955121217 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Passing because is not Client Key Exchange

Pkt #346676018 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #346676018 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1863513135 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

Pkt #1955122358 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56392, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #346676019 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56392, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #830185988 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }

Pkt #1863513136 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

Pkt #1863513136 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("tls-v1-2.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 293 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 293
      4: This packet is inserted, quack

Pkt #830185989 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }

Pkt #830185989 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #830187397 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #830188805 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #1863513429 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1863513429 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1863513429 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1863513429 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }
Matching server name
Result is Some(DNSName("tls-v1-2.badssl.com"))
ServerName is: Some(DNSName("tls-v1-2.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("tls-v1-2.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #598270637 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #830189425 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #1863513555 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1863513555 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 178
Inserted
reading size of 178 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 178
Passing because is not Client Key Exchange

Pkt #830189683 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 440
Inserted
reading size of 440 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 440
Passing because is not Client Key Exchange

Pkt #1863513733 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2371540570 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

Pkt #3592262090 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }

Pkt #2371540571 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

Pkt #2371540571 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("tls-v1-2.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 293 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 293
      4: This packet is inserted, quack

Pkt #3592262091 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }

Pkt #3592262091 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #3592263499 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3592264907 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 616
Inserted
reading size of 616 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 616
Passing because is not Client Key Exchange

Pkt #2371540864 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2371540864 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2371540864 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2371540864 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }
Matching server name
Result is Some(DNSName("tls-v1-2.badssl.com"))
ServerName is: Some(DNSName("tls-v1-2.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }
ServerHello

And the magic number is 71

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("tls-v1-2.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #598270681 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598270789 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598271557 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3592265523 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #2371540990 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2371540990 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 183
Inserted
reading size of 183 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 183
Passing because is not Client Key Exchange

Pkt #3592265781 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 778
Inserted
reading size of 778 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 778
Passing because is not Client Key Exchange

Pkt #2371541173 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1863513733 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 31
Inserted
reading size of 31 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 31
Passing because is not Client Key Exchange

Pkt #1863513764 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2371541173 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1040350878 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

Pkt #830190123 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56393, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1863513765 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56393, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3592266559 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56394, dst_port: 1012, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2371541174 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 1012, dst_port: 56394, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1894630649 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }

Pkt #1040350879 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

Pkt #1040350879 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("sha256.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 291 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 291
      4: This packet is inserted, quack

Pkt #598272221 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #1894630650 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }

Pkt #1894630650 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #1894632058 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #1894633466 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #1040351170 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1040351170 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1040351170 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1040351170 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }
Matching server name
Result is Some(DNSName("sha256.badssl.com"))
ServerName is: Some(DNSName("sha256.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("sha256.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #1894634086 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #1040351296 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1040351296 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 176
Inserted
reading size of 176 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 176
Passing because is not Client Key Exchange

Pkt #1894634344 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 774
Inserted
reading size of 774 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 774
Passing because is not Client Key Exchange

Pkt #1040351472 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1040351472 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598272265 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2121555009 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

Pkt #1894635118 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56395, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1040351473 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56395, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3521677805 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }

Pkt #2121555010 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

Pkt #2121555010 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("rsa2048.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 292 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 292
      4: This packet is inserted, quack

Pkt #3521677806 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }

Pkt #3521677806 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #3521679214 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #3521680622 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #2121555302 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2121555302 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2121555302 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2121555302 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }
Matching server name
Result is Some(DNSName("rsa2048.badssl.com"))
ServerName is: Some(DNSName("rsa2048.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("rsa2048.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #3349289870 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 576669647, src_port: 443, dst_port: 56347, proto: 6 }

Pkt #3521681242 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #3349289916 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 576669647, src_port: 443, dst_port: 56347, proto: 6 }

Pkt #3349289947 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 576669647, src_port: 443, dst_port: 56347, proto: 6 }

Pkt #2121555428 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2121555428 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 177
Inserted
reading size of 177 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 177
Passing because is not Client Key Exchange

Pkt #148250483 is Vacant

And the flow is: Flow { src_ip: 576669647, dst_ip: 180932078, src_port: 56347, dst_port: 443, proto: 6 }

Pkt #148250483 is Vacant

And the flow is: Flow { src_ip: 576669647, dst_ip: 180932078, src_port: 56347, dst_port: 443, proto: 6 }

Pkt #3349289948 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 576669647, src_port: 443, dst_port: 56347, proto: 6 }

Pkt #598272309 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3521681500 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 879
Inserted
reading size of 879 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 879
Passing because is not Client Key Exchange

Pkt #2121555605 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2121555605 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1063672721 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

Pkt #3521682379 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56396, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2121555606 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56396, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #4027869569 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }

Pkt #1063672722 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

Pkt #1063672722 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("ecc256.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 291 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 291
      4: This packet is inserted, quack

Pkt #4027869570 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }

Pkt #4027869570 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #4027870978 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1245
Inserted
reading size of 1245 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1245
Passing because is not Client Key Exchange

Pkt #1063673013 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1063673013 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1063673013 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }
Matching server name
Result is Some(DNSName("ecc256.badssl.com"))
ServerName is: Some(DNSName("ecc256.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("ecc256.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #598272353 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #4027872223 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #1063673139 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1063673139 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 176
Inserted
reading size of 176 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 176
Passing because is not Client Key Exchange

Pkt #4027872481 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 960
Inserted
reading size of 960 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 960
Passing because is not Client Key Exchange

Pkt #1063673315 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1063673315 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1888405079 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

Pkt #4027873441 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56397, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1063673316 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56397, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2662724408 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }

Pkt #1888405080 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

Pkt #1888405080 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("ecc384.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 291 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 291
      4: This packet is inserted, quack

Pkt #2219708966 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 583969878, src_port: 443, dst_port: 62030, proto: 6 }

Pkt #598272397 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2551028096 is Vacant

And the flow is: Flow { src_ip: 583969878, dst_ip: 180932078, src_port: 62030, dst_port: 443, proto: 6 }

Pkt #2219709026 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 583969878, src_port: 443, dst_port: 62030, proto: 6 }

Pkt #2662724409 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }

Pkt #2662724409 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #2662725817 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1307
Inserted
reading size of 1307 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1307
Passing because is not Client Key Exchange

Pkt #1888405371 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1888405371 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 1888405371 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }
Matching server name
Result is Some(DNSName("ecc384.badssl.com"))
ServerName is: Some(DNSName("ecc384.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("ecc384.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #2662727124 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 258
Inserted
reading size of 258 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 258
Passing because is not Client Key Exchange

Pkt #1888405497 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1888405497 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 176
Inserted
reading size of 176 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 176
Passing because is not Client Key Exchange

Pkt #2662727382 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 960
Inserted
reading size of 960 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 960
Passing because is not Client Key Exchange

Pkt #1888405673 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1888405673 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2395310307 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

Pkt #2662728342 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56398, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #1888405674 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56398, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598272441 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3525754514 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }

Pkt #2395310308 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

Pkt #2395310308 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("extended-validation.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 304 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 304
      4: This packet is inserted, quack

Pkt #3525754515 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }

Pkt #3525754515 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #3525755923 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2395310612 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3525757331 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 729
Inserted
reading size of 729 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 729
Passing because is not Client Key Exchange

Pkt #2395310612 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2395310612 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2395310612 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }
Matching server name
Result is Some(DNSName("extended-validation.badssl.com"))
ServerName is: Some(DNSName("extended-validation.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("extended-validation.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #3525758060 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 274
Inserted
reading size of 274 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 274
Passing because is not Client Key Exchange

Pkt #2395310738 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2395310738 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 189
Inserted
reading size of 189 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 189
Passing because is not Client Key Exchange

Pkt #598272485 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #3525758334 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 976
Inserted
reading size of 976 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 976
Passing because is not Client Key Exchange

Pkt #2395310927 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2395310927 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #3680358277 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 315848213, src_port: 443, dst_port: 62194, proto: 6 }

Pkt #2601116812 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

Pkt #1077942475 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 180932078, src_port: 62194, dst_port: 443, proto: 6 }

Pkt #1077942475 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 180932078, src_port: 62194, dst_port: 443, proto: 6 }

Pkt #3680358340 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 315848213, src_port: 443, dst_port: 62194, proto: 6 }

Pkt #3525759310 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56399, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2395310928 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56399, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2125903547 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }

Pkt #2601116813 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

Pkt #2601116813 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }
DEBUG: ClientHello
Matching server name
Result is Some(DNSName("mozilla-modern.badssl.com"))
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 299 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 299
      4: This packet is inserted, quack

Pkt #2125903548 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }

Pkt #2125903548 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
      4: This packet is inserted, quack

Pkt #2125904956 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1408
Inserted
reading size of 1408 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1408
Passing because is not Client Key Exchange

Pkt #2125906364 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 620
Inserted
reading size of 620 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 620
Passing because is not Client Key Exchange

Pkt #2601117112 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2601117112 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2601117112 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126

important: Pkt 2601117112 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }
Matching server name
Result is Some(DNSName("mozilla-modern.badssl.com"))
ServerName is: Some(DNSName("mozilla-modern.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }
ServerHello

And the magic number is 75

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload


Testing our cert

DEBUG: validate certs

dns name is DNSName("mozilla-modern.badssl.com")

DEBUG: 
It worked!!!
Result of the cert validation is true

Pkt #598272529 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #598272637 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #598273121 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #2125906984 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 274
Inserted
reading size of 274 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 274
Passing because is not Client Key Exchange

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2601117238 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #2601117238 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 184
Inserted
reading size of 184 payload into the flow entry 
Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 184
Passing because is not Client Key Exchange

Pkt #2125907258 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 990
Inserted
reading size of 990 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 990
Passing because is not Client Key Exchange

Pkt #2601117422 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2601117422 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2125908248 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 180932078, src_port: 56400, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #2601117423 is Occupied!
And the flow is: Flow { src_ip: 180932078, dst_ip: 1754945897, src_port: 443, dst_port: 56400, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0
Passing because is not Client Key Exchange

Pkt #598274033 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274077 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274121 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274165 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274209 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274253 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274297 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274341 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274449 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598274925 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }

Pkt #404819106 is Vacant

And the flow is: Flow { src_ip: 180932078, dst_ip: 180907851, src_port: 22, dst_port: 52616, proto: 6 }

Pkt #598275837 is Vacant

And the flow is: Flow { src_ip: 180907851, dst_ip: 180932078, src_port: 52616, dst_port: 22, proto: 6 }
15.01 OVERALL RX 67.64 TX 67.64
