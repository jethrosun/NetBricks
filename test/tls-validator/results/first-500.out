Going to start with configuration Configuration: name:  =========== Running TLS Validator ============   mempool size: 2047 core cache: 32 primary core: 0
 Ports:
	Port 0000:01:00.0 RXQ_Count: 1 RX_Queues: [ 2 ] TXQ_Count: 1 TX_Queues: 2 RXD: 128 TXD: 128 Loopback false
	Port 0000:01:00.1 RXQ_Count: 1 RX_Queues: [ 3 ] TXQ_Count: 1 TX_Queues: 3 RXD: 128 TXD: 128 Loopback false
Cores:
	2
	3
	4
	5
	6
	7
	8
	9
	10
	11

EAL: Probing VFIO support...
Running on node 0
Devname: "0000:01:00.0"
EAL: PCI device 0000:01:00.0 on NUMA socket -1
EAL:   Invalid NUMA socket, default to 0
EAL:   probe driver: 8086:1583 net_i40e
Going to try and use port 0
Devname: "0000:01:00.1"
EAL: PCI device 0000:01:00.1 on NUMA socket -1
EAL:   Invalid NUMA socket, default to 0
EAL:   probe driver: 8086:1583 net_i40e
Going to try and use port 1
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running on node 0
Running 0 pipelines
Running on node 0
Running on node 0
Running on node 0
Running 0 pipelines
Running 0 pipelines
Receiving port f8:f2:1e:2e:9c:50 rxq 0 txq 0
Starting scheduler on 4
Running 0 pipelines
Running 0 pipelines
Running 0 pipelines
Starting scheduler on 7
Running 0 pipelines
Receiving port f8:f2:1e:2e:9c:51 rxq 0 txq 0
Running 0 pipelines
Running 1 pipelines
Starting scheduler on 2
Starting scheduler on 8
Running 1 pipelines
Starting scheduler on 9
Starting scheduler on 5
Starting scheduler on 6
Starting scheduler on 11
Starting scheduler on 10
Starting scheduler on 3
0 OVERALL RX 0.00 TX 0.00 CYCLE_PER_DELAY 0 0 0


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622272 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 58302 urgent 0
Total 1

Pkt #2674622272 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47000 seq 871510396 ack 2674622273 data_offset 10 flags | ACK SYN |cwnd 28160 csum 28168 urgent 0
Total 2

Pkt #871510396 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622273 ack 871510397 data_offset 8 flags | ACK |cwnd 229 csum 2393 urgent 0
Total 3

Pkt #2674622273 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622273 ack 871510397 data_offset 8 flags | ACK PSH |cwnd 229 csum 54349 urgent 0
Total 4

Pkt #2674622273 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("expired.badssl.com")
DEBUG: Result is Some(DNSName("expired.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 320 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 320
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47000 seq 871510397 ack 2674622593 data_offset 8 flags | ACK |cwnd 229 csum 2016 urgent 0
Total 5

Pkt #871510397 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47000 seq 871510397 ack 2674622593 data_offset 8 flags | ACK |cwnd 229 csum 24883 urgent 0
Total 6

Pkt #871510397 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622593 ack 871511745 data_offset 8 flags | ACK |cwnd 250 csum 589 urgent 0
Total 7

Pkt #2674622593 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622593 ack 871514441 data_offset 8 flags | ACK |cwnd 292 csum 63384 urgent 0
Total 8

Pkt #2674622593 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47000 seq 871514441 ack 2674622593 data_offset 8 flags | ACK PSH |cwnd 229 csum 7386 urgent 0
Total 9

Pkt #871514441 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622593 ack 871515142 data_offset 8 flags | ACK |cwnd 313 csum 62662 urgent 0
Total 10

Pkt #2674622593 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622593 ack 871515142 data_offset 8 flags | ACK PSH |cwnd 313 csum 31850 urgent 0
Total 11

Pkt #2674622593 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 2674622593 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }
Matching server name
DNS name is : DNSName("expired.badssl.com")
DEBUG: Result is Some(DNSName("expired.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("expired.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([f0, 46, c7, 82, 1b, cb, ba, ec, b1, ba, 83, b6, 11, fe, 1a, 11, 74, ff, 13, 4a, 36, 54, 8, bf, cb, 8a, 5b, a6, 63, 9f, bf, 76]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70


ON FRAME: Read bytes but got None
DEBUG: Get None, abort

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }
DEBUG: error: CertificateNotExtractedError
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47000 seq 871515142 ack 2674622719 data_offset 8 flags | ACK PSH |cwnd 229 csum 968 urgent 0
Total 12

Pkt #871515142 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
not Client Key Exchange
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622719 ack 871515400 data_offset 8 flags | ACK PSH |cwnd 334 csum 28985 urgent 0
Total 13

Pkt #2674622719 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 174
Inserted
reading size of 174 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 174
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47000 seq 871515400 ack 2674622893 data_offset 8 flags | ACK PSH |cwnd 237 csum 11628 urgent 0
Total 14

Pkt #871515400 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622893 ack 871516170 data_offset 8 flags | ACK FIN |cwnd 355 csum 61079 urgent 0
Total 15

Pkt #2674622893 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47000 seq 871516170 ack 2674622894 data_offset 8 flags | ACK FIN |cwnd 237 csum 61142 urgent 0
Total 16

Pkt #871516170 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47000, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47000 dst_port 443 seq 2674622894 ack 871516171 data_offset 8 flags | ACK |cwnd 355 csum 60973 urgent 0
Total 17

Pkt #2674622894 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47000, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932328 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 29722 urgent 0
Total 18

Pkt #36932328 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47002 seq 409522704 ack 36932329 data_offset 10 flags | ACK SYN |cwnd 28160 csum 30758 urgent 0
Total 19

Pkt #409522704 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932329 ack 409522705 data_offset 8 flags | ACK |cwnd 229 csum 4983 urgent 0
Total 20

Pkt #36932329 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932329 ack 409522705 data_offset 8 flags | ACK PSH |cwnd 229 csum 21217 urgent 0
Total 21

Pkt #36932329 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("wrong.host.badssl.com")
DEBUG: Result is Some(DNSName("wrong.host.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 323 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 323
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47002 seq 409522705 ack 36932652 data_offset 8 flags | ACK |cwnd 229 csum 4603 urgent 0
Total 22

Pkt #409522705 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47002 seq 409522705 ack 36932652 data_offset 8 flags | ACK |cwnd 229 csum 25969 urgent 0
Total 23

Pkt #409522705 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932652 ack 409524053 data_offset 8 flags | ACK |cwnd 250 csum 3175 urgent 0
Total 24

Pkt #36932652 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47002 seq 409525401 ack 36932652 data_offset 8 flags | ACK PSH |cwnd 229 csum 38506 urgent 0
Total 25

Pkt #409525401 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932652 ack 409524053 data_offset 11 flags | ACK |cwnd 271 csum 59733 urgent 0
Total 26

Pkt #36932652 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47002 seq 409524053 ack 36932652 data_offset 8 flags | ACK |cwnd 229 csum 22389 urgent 0
Total 27

Pkt #409524053 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 2083
Inserted
reading size of 2083 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 2083

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932652 ack 409526136 data_offset 8 flags | ACK |cwnd 292 csum 1048 urgent 0
Total 28

Pkt #36932652 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932652 ack 409526136 data_offset 8 flags | ACK PSH |cwnd 292 csum 8374 urgent 0
Total 29

Pkt #36932652 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 36932652 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }
Matching server name
DNS name is : DNSName("wrong.host.badssl.com")
DEBUG: Result is Some(DNSName("wrong.host.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("wrong.host.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([7c, bd, 5e, 94, 97, cb, c1, 63, 82, f3, 72, 99, 6f, d3, 85, a7, 2b, 95, 1b, c, 9, fe, dc, 66, 14, 8e, 69, a6, af, 90, d8, 57]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("wrong.host.badssl.com")

DEBUG: 
Oops, error: invalid certificate: CertNotValidForName
DEBUG: cert count is 1
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47002 seq 409526136 ack 36932778 data_offset 8 flags | ACK PSH |cwnd 229 csum 57841 urgent 0
Total 30

Pkt #409526136 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47002 dst_port 443 seq 36932778 ack 409526410 data_offset 8 flags | ACK PSH |cwnd 313 csum 3309 urgent 0
Total 31

Pkt #36932778 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47002 seq 409526410 ack 36932955 data_offset 8 flags | ACK PSH |cwnd 237 csum 54676 urgent 0
Total 32

Pkt #409526410 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932955 ack 409527186 data_offset 8 flags | ACK FIN |cwnd 334 csum 64980 urgent 0
Total 33

Pkt #36932955 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47002 seq 409527186 ack 36932956 data_offset 8 flags | ACK FIN |cwnd 237 csum 65023 urgent 0
Total 34

Pkt #409527186 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47002, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47002 dst_port 443 seq 36932956 ack 409527187 data_offset 8 flags | ACK |cwnd 334 csum 64875 urgent 0
Total 35

Pkt #36932956 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47002, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47004 dst_port 443 seq 3953177717 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 24572 urgent 0
Total 36

Pkt #3953177717 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47004 seq 2601670899 ack 3953177718 data_offset 10 flags | ACK SYN |cwnd 28160 csum 22875 urgent 0
Total 37

Pkt #2601670899 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47004 dst_port 443 seq 3953177718 ack 2601670900 data_offset 8 flags | ACK |cwnd 229 csum 62636 urgent 0
Total 38

Pkt #3953177718 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47004 dst_port 443 seq 3953177718 ack 2601670900 data_offset 8 flags | ACK PSH |cwnd 229 csum 18933 urgent 0
Total 39

Pkt #3953177718 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("self-signed.badssl.com")
DEBUG: Result is Some(DNSName("self-signed.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 324 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 324
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47004 seq 2601670900 ack 3953178042 data_offset 8 flags | ACK |cwnd 229 csum 62256 urgent 0
Total 40

Pkt #2601670900 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47004 seq 2601670900 ack 3953178042 data_offset 8 flags | ACK PSH |cwnd 229 csum 17576 urgent 0
Total 41

Pkt #2601670900 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1325 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1325
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47004 dst_port 443 seq 3953178042 ack 2601672225 data_offset 8 flags | ACK |cwnd 249 csum 60854 urgent 0
Total 42

Pkt #3953178042 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47004 dst_port 443 seq 3953178042 ack 2601672225 data_offset 8 flags | ACK PSH |cwnd 249 csum 21238 urgent 0
Total 43

Pkt #3953178042 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 3953178042 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }
Matching server name
DNS name is : DNSName("self-signed.badssl.com")
DEBUG: Result is Some(DNSName("self-signed.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("self-signed.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([10, bb, 28, 35, 96, 6f, 56, f9, e6, 6e, bd, ef, 8b, 6c, 7f, c8, 15, 1c, 1a, 3b, f6, 70, 7b, e8, ba, 2e, 30, 5f, 36, 4c, e9, 9d]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("self-signed.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
DEBUG: cert count is 2
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47004 seq 2601672225 ack 3953178168 data_offset 8 flags | ACK PSH |cwnd 229 csum 25395 urgent 0
Total 44

Pkt #2601672225 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47004 dst_port 443 seq 3953178168 ack 2601672499 data_offset 8 flags | ACK PSH |cwnd 270 csum 48998 urgent 0
Total 45

Pkt #3953178168 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47004 seq 2601672499 ack 3953178346 data_offset 8 flags | ACK PSH |cwnd 237 csum 52240 urgent 0
Total 46

Pkt #2601672499 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47004 dst_port 443 seq 3953178346 ack 2601673277 data_offset 8 flags | ACK FIN |cwnd 291 csum 59249 urgent 0
Total 47

Pkt #3953178346 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47004 seq 2601673277 ack 3953178347 data_offset 8 flags | ACK FIN |cwnd 237 csum 59250 urgent 0
Total 48

Pkt #2601673277 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47004, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47004 dst_port 443 seq 3953178347 ack 2601673278 data_offset 8 flags | ACK |cwnd 291 csum 59146 urgent 0
Total 49

Pkt #3953178347 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47004, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104479810 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 45369 urgent 0
Total 50

Pkt #2104479810 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47006 seq 45775312 ack 2104479811 data_offset 10 flags | ACK SYN |cwnd 28160 csum 8430 urgent 0
Total 51

Pkt #45775312 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47006, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104479811 ack 45775313 data_offset 8 flags | ACK |cwnd 229 csum 48190 urgent 0
Total 52

Pkt #2104479811 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104479811 ack 45775313 data_offset 8 flags | ACK PSH |cwnd 229 csum 34093 urgent 0
Total 53

Pkt #2104479811 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("untrusted-root.badssl.com")
DEBUG: Result is Some(DNSName("untrusted-root.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 327 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 327
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47006 seq 45775313 ack 2104480138 data_offset 8 flags | ACK |cwnd 229 csum 47802 urgent 0
Total 54

Pkt #45775313 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47006, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104480138 ack 45776926 data_offset 8 flags | ACK |cwnd 254 csum 46102 urgent 0
Total 55

Pkt #2104480138 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104480138 ack 45776926 data_offset 8 flags | ACK PSH |cwnd 254 csum 64587 urgent 0
Total 56

Pkt #2104480138 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 2104480138 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }
Matching server name
DNS name is : DNSName("untrusted-root.badssl.com")
DEBUG: Result is Some(DNSName("untrusted-root.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("untrusted-root.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47006, dst_port: 443, proto: 6 }
DEBUG: We had a problem: the entry of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47006, dst_port: 443, proto: 6 } doesn't exist
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47006 seq 45776926 ack 2104480264 data_offset 8 flags | ACK PSH |cwnd 229 csum 14794 urgent 0
Total 57

Pkt #45776926 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47006, dst_port: 443, proto: 6 }
not client hello
not client hello
not server hello


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104480264 ack 45777200 data_offset 8 flags | ACK PSH |cwnd 275 csum 22846 urgent 0
Total 58

Pkt #2104480264 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 181
Inserted
reading size of 181 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 181
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47006 seq 45777200 ack 2104480445 data_offset 8 flags | ACK PSH |cwnd 237 csum 23071 urgent 0
Total 59

Pkt #45777200 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47006, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104480445 ack 45778076 data_offset 8 flags | ACK FIN |cwnd 296 csum 44399 urgent 0
Total 60

Pkt #2104480445 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47006 seq 45778076 ack 2104480446 data_offset 8 flags | ACK FIN |cwnd 237 csum 44405 urgent 0
Total 61

Pkt #45778076 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47006, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47006 dst_port 443 seq 2104480446 ack 45778077 data_offset 8 flags | ACK |cwnd 296 csum 44295 urgent 0
Total 62

Pkt #2104480446 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47006, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47008 dst_port 443 seq 1698755695 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 42005 urgent 0
Total 63

Pkt #1698755695 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47008 seq 1417952463 ack 1698755696 data_offset 10 flags | ACK SYN |cwnd 28160 csum 64987 urgent 0
Total 64

Pkt #1417952463 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47008 dst_port 443 seq 1698755696 ack 1417952464 data_offset 8 flags | ACK |cwnd 229 csum 39212 urgent 0
Total 65

Pkt #1698755696 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47008 dst_port 443 seq 1698755696 ack 1417952464 data_offset 8 flags | ACK PSH |cwnd 229 csum 56071 urgent 0
Total 66

Pkt #1698755696 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("superfish.badssl.com")
DEBUG: Result is Some(DNSName("superfish.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 322 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 322
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47008 seq 1417952464 ack 1698756018 data_offset 8 flags | ACK |cwnd 229 csum 38831 urgent 0
Total 67

Pkt #1417952464 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47008 seq 1417952464 ack 1698756018 data_offset 8 flags | ACK PSH |cwnd 229 csum 16826 urgent 0
Total 68

Pkt #1417952464 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1193 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1193
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47008 dst_port 443 seq 1698756018 ack 1417953657 data_offset 8 flags | ACK |cwnd 247 csum 37560 urgent 0
Total 69

Pkt #1698756018 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47008 dst_port 443 seq 1698756018 ack 1417953657 data_offset 8 flags | ACK PSH |cwnd 247 csum 17637 urgent 0
Total 70

Pkt #1698756018 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 1698756018 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }
Matching server name
DNS name is : DNSName("superfish.badssl.com")
DEBUG: Result is Some(DNSName("superfish.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("superfish.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([34, ff, 90, 17, 40, 54, 41, e3, d8, 7c, a8, e2, 65, 8, b2, 42, aa, 8b, a9, a9, 47, 51, bd, e8, 97, d3, 4d, e6, 75, bb, bf, a2]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("superfish.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
DEBUG: cert count is 3
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47008 seq 1417953657 ack 1698756144 data_offset 8 flags | ACK PSH |cwnd 229 csum 55908 urgent 0
Total 71

Pkt #1417953657 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47008 dst_port 443 seq 1698756144 ack 1417953915 data_offset 8 flags | ACK PSH |cwnd 266 csum 6065 urgent 0
Total 72

Pkt #1698756144 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47008 seq 1417953915 ack 1698756320 data_offset 8 flags | ACK PSH |cwnd 237 csum 16119 urgent 0
Total 73

Pkt #1417953915 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47008 dst_port 443 seq 1698756320 ack 1417954689 data_offset 8 flags | ACK FIN |cwnd 285 csum 35990 urgent 0
Total 74

Pkt #1698756320 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47008 seq 1417954689 ack 1698756321 data_offset 8 flags | ACK FIN |cwnd 237 csum 35985 urgent 0
Total 75

Pkt #1417954689 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47008, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47008 dst_port 443 seq 1698756321 ack 1417954690 data_offset 8 flags | ACK |cwnd 285 csum 35886 urgent 0
Total 76

Pkt #1698756321 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47008, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47010 dst_port 443 seq 602284292 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 47045 urgent 0
Total 77

Pkt #602284292 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47010 seq 875293716 ack 602284293 data_offset 10 flags | ACK SYN |cwnd 28160 csum 33166 urgent 0
Total 78

Pkt #875293716 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47010 dst_port 443 seq 602284293 ack 875293717 data_offset 8 flags | ACK |cwnd 229 csum 7393 urgent 0
Total 79

Pkt #602284293 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47010 dst_port 443 seq 602284293 ack 875293717 data_offset 8 flags | ACK PSH |cwnd 229 csum 14260 urgent 0
Total 80

Pkt #602284293 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("edellroot.badssl.com")
DEBUG: Result is Some(DNSName("edellroot.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 322 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 322
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47010 seq 875293717 ack 602284615 data_offset 8 flags | ACK |cwnd 229 csum 7015 urgent 0
Total 81

Pkt #875293717 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47010 seq 875293717 ack 602284615 data_offset 8 flags | ACK PSH |cwnd 229 csum 17205 urgent 0
Total 82

Pkt #875293717 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1251 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1251
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47010 dst_port 443 seq 602284615 ack 875294968 data_offset 8 flags | ACK |cwnd 248 csum 5689 urgent 0
Total 83

Pkt #602284615 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47010 dst_port 443 seq 602284615 ack 875294968 data_offset 8 flags | ACK PSH |cwnd 248 csum 49175 urgent 0
Total 84

Pkt #602284615 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 602284615 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }
Matching server name
DNS name is : DNSName("edellroot.badssl.com")
DEBUG: Result is Some(DNSName("edellroot.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("edellroot.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([62, 7d, 69, 94, 86, 86, 4a, 53, 95, 8b, ff, 5f, 33, 74, 40, 34, 43, 9e, 3, 5c, 4c, e7, e8, 10, 42, a4, 40, 21, f, ed, bd, 52]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("edellroot.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
DEBUG: cert count is 4
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47010 seq 875294968 ack 602284741 data_offset 8 flags | ACK PSH |cwnd 229 csum 62751 urgent 0
Total 85

Pkt #875294968 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47010 dst_port 443 seq 602284741 ack 875295226 data_offset 8 flags | ACK PSH |cwnd 268 csum 38591 urgent 0
Total 86

Pkt #602284741 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47010 seq 875295226 ack 602284917 data_offset 8 flags | ACK PSH |cwnd 237 csum 30505 urgent 0
Total 87

Pkt #875295226 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47010 dst_port 443 seq 602284917 ack 875296000 data_offset 8 flags | ACK FIN |cwnd 287 csum 4113 urgent 0
Total 88

Pkt #602284917 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47010 seq 875296000 ack 602284918 data_offset 8 flags | ACK FIN |cwnd 237 csum 4106 urgent 0
Total 89

Pkt #875296000 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47010, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47010 dst_port 443 seq 602284918 ack 875296001 data_offset 8 flags | ACK |cwnd 287 csum 4002 urgent 0
Total 90

Pkt #602284918 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47010, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694133 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 399 urgent 0
Total 91

Pkt #3839694133 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47012 seq 2097007948 ack 3839694134 data_offset 10 flags | ACK SYN |cwnd 28160 csum 41022 urgent 0
Total 92

Pkt #2097007948 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694134 ack 2097007949 data_offset 8 flags | ACK |cwnd 229 csum 15247 urgent 0
Total 93

Pkt #3839694134 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694134 ack 2097007949 data_offset 8 flags | ACK PSH |cwnd 229 csum 62293 urgent 0
Total 94

Pkt #3839694134 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("dsdtestprovider.badssl.com")
DEBUG: Result is Some(DNSName("dsdtestprovider.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 328 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 328
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47012 seq 2097007949 ack 3839694462 data_offset 8 flags | ACK |cwnd 229 csum 14863 urgent 0
Total 95

Pkt #2097007949 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47012 seq 2097007949 ack 3839694462 data_offset 8 flags | ACK |cwnd 229 csum 10210 urgent 0
Total 96

Pkt #2097007949 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694462 ack 2097009297 data_offset 8 flags | ACK |cwnd 250 csum 13437 urgent 0
Total 97

Pkt #3839694462 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47012 seq 2097009297 ack 3839694462 data_offset 8 flags | ACK PSH |cwnd 229 csum 64678 urgent 0
Total 98

Pkt #2097009297 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 229
Inserted
reading size of 229 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 229

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694462 ack 2097009526 data_offset 8 flags | ACK |cwnd 271 csum 13185 urgent 0
Total 99

Pkt #3839694462 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694462 ack 2097009526 data_offset 8 flags | ACK PSH |cwnd 271 csum 10445 urgent 0
Total 100

Pkt #3839694462 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 3839694462 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }
Matching server name
DNS name is : DNSName("dsdtestprovider.badssl.com")
DEBUG: Result is Some(DNSName("dsdtestprovider.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("dsdtestprovider.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([90, 6, b8, a3, aa, 5b, 63, 3d, fc, 18, a9, 8b, 31, 7e, 50, e5, d7, 97, 82, 38, 7c, 26, 35, 4b, 20, b4, cf, 8a, 39, 5c, 40, 46]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("dsdtestprovider.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
DEBUG: cert count is 5
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47012 seq 2097009526 ack 3839694588 data_offset 8 flags | ACK PSH |cwnd 229 csum 33072 urgent 0
Total 101

Pkt #2097009526 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694588 ack 2097009800 data_offset 8 flags | ACK PSH |cwnd 292 csum 7361 urgent 0
Total 102

Pkt #3839694588 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47012 seq 2097009800 ack 3839694770 data_offset 8 flags | ACK PSH |cwnd 237 csum 54440 urgent 0
Total 103

Pkt #2097009800 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694770 ack 2097010586 data_offset 8 flags | ACK FIN |cwnd 313 csum 11537 urgent 0
Total 104

Pkt #3839694770 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47012 seq 2097010586 ack 3839694771 data_offset 8 flags | ACK FIN |cwnd 237 csum 11561 urgent 0
Total 105

Pkt #2097010586 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47012, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47012 dst_port 443 seq 3839694771 ack 2097010587 data_offset 8 flags | ACK |cwnd 313 csum 11436 urgent 0
Total 106

Pkt #3839694771 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47012, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47014 dst_port 443 seq 2643071692 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 18968 urgent 0
Total 107

Pkt #2643071692 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 56612 dst_port 443 seq 2872291918 ack 3660793256 data_offset 8 flags | ACK PSH |cwnd 1444 csum 42181 urgent 0
Total 108

Pkt #2872291918 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56612, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 56614 dst_port 443 seq 3123752032 ack 3574534518 data_offset 8 flags | ACK PSH |cwnd 1444 csum 62843 urgent 0
Total 109

Pkt #3123752032 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56614, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 56616 dst_port 443 seq 347007698 ack 945593058 data_offset 8 flags | ACK PSH |cwnd 1444 csum 32560 urgent 0
Total 110

Pkt #347007698 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56616, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 56618 dst_port 443 seq 3122206692 ack 1472919957 data_offset 8 flags | ACK PSH |cwnd 1444 csum 31488 urgent 0
Total 111

Pkt #3122206692 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56618, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 443 dst_port 47014 seq 1056524386 ack 2643071693 data_offset 10 flags | ACK SYN |cwnd 28160 csum 43653 urgent 0
Total 112

Pkt #1056524386 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47014 dst_port 443 seq 2643071693 ack 1056524387 data_offset 8 flags | ACK |cwnd 229 csum 17873 urgent 0
Total 113

Pkt #2643071693 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47014 dst_port 443 seq 2643071693 ack 1056524387 data_offset 8 flags | ACK PSH |cwnd 229 csum 52769 urgent 0
Total 114

Pkt #2643071693 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("preact-cli.badssl.com")
DEBUG: Result is Some(DNSName("preact-cli.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 323 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 323
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 56612 seq 3660793256 ack 2872291995 data_offset 8 flags | ACK |cwnd 9 csum 37734 urgent 0
Total 115

Pkt #3660793256 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56612, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 56612 seq 3660793256 ack 2872291995 data_offset 8 flags | ACK PSH |cwnd 9 csum 55672 urgent 0
Total 116

Pkt #3660793256 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56612, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 56612 dst_port 443 seq 2872291995 ack 3660793540 data_offset 8 flags | ACK |cwnd 1442 csum 35988 urgent 0
Total 117

Pkt #2872291995 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56612, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 56614 seq 3574534518 ack 3123752109 data_offset 8 flags | ACK |cwnd 9 csum 39538 urgent 0
Total 118

Pkt #3574534518 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56614, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 56616 seq 945593058 ack 347007775 data_offset 8 flags | ACK |cwnd 9 csum 4981 urgent 0
Total 119

Pkt #945593058 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56616, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 56618 seq 1472919957 ack 3122206769 data_offset 8 flags | ACK |cwnd 9 csum 35719 urgent 0
Total 120

Pkt #1472919957 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56618, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 56616 seq 945593058 ack 347007775 data_offset 8 flags | ACK PSH |cwnd 9 csum 54945 urgent 0
Total 121

Pkt #945593058 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56616, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 56616 dst_port 443 seq 347007775 ack 945593343 data_offset 8 flags | ACK |cwnd 1442 csum 3227 urgent 0
Total 122

Pkt #347007775 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56616, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 56618 seq 1472919957 ack 3122206769 data_offset 8 flags | ACK PSH |cwnd 9 csum 39839 urgent 0
Total 123

Pkt #1472919957 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56618, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 56618 dst_port 443 seq 3122206769 ack 1472920242 data_offset 8 flags | ACK |cwnd 1444 csum 33962 urgent 0
Total 124

Pkt #3122206769 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56618, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 56614 seq 3574534518 ack 3123752109 data_offset 8 flags | ACK PSH |cwnd 9 csum 28455 urgent 0
Total 125

Pkt #3574534518 is Vacant

And the flow is: Flow { src_ip: 315848213, dst_ip: 2886997012, src_port: 56614, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 56614 dst_port 443 seq 3123752109 ack 3574534802 data_offset 8 flags | ACK |cwnd 1444 csum 37781 urgent 0
Total 126

Pkt #3123752109 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 315848213, src_port: 443, dst_port: 56614, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47014 seq 1056524387 ack 2643072016 data_offset 8 flags | ACK |cwnd 229 csum 17489 urgent 0
Total 127

Pkt #1056524387 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47014 seq 1056524387 ack 2643072016 data_offset 8 flags | ACK PSH |cwnd 229 csum 41574 urgent 0
Total 128

Pkt #1056524387 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1251 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1251
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47014 dst_port 443 seq 2643072016 ack 1056525638 data_offset 8 flags | ACK |cwnd 248 csum 16162 urgent 0
Total 129

Pkt #2643072016 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47014 dst_port 443 seq 2643072016 ack 1056525638 data_offset 8 flags | ACK PSH |cwnd 248 csum 2007 urgent 0
Total 130

Pkt #2643072016 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 2643072016 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }
Matching server name
DNS name is : DNSName("preact-cli.badssl.com")
DEBUG: Result is Some(DNSName("preact-cli.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("preact-cli.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([4f, a4, f1, d4, b2, 35, af, 11, 8c, 3e, d4, 68, 12, 2, 7f, 6d, bb, c7, 50, fb, 1b, 7c, 23, 4c, cf, b6, 23, c9, 3b, 7a, 20, fa]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("preact-cli.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
DEBUG: cert count is 6
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47014 seq 1056525638 ack 2643072142 data_offset 8 flags | ACK PSH |cwnd 229 csum 25011 urgent 0
Total 131

Pkt #1056525638 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47014 dst_port 443 seq 2643072142 ack 1056525912 data_offset 8 flags | ACK PSH |cwnd 268 csum 59249 urgent 0
Total 132

Pkt #2643072142 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47014 seq 1056525912 ack 2643072319 data_offset 8 flags | ACK PSH |cwnd 237 csum 10161 urgent 0
Total 133

Pkt #1056525912 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47014 dst_port 443 seq 2643072319 ack 1056526688 data_offset 8 flags | ACK FIN |cwnd 287 csum 14563 urgent 0
Total 134

Pkt #2643072319 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47014 seq 1056526688 ack 2643072320 data_offset 8 flags | ACK FIN |cwnd 237 csum 14560 urgent 0
Total 135

Pkt #1056526688 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47014, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47014 dst_port 443 seq 2643072320 ack 1056526689 data_offset 8 flags | ACK |cwnd 287 csum 14459 urgent 0
Total 136

Pkt #2643072320 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47014, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857158 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 50540 urgent 0
Total 137

Pkt #1510857158 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47016 seq 189629613 ack 1510857159 data_offset 10 flags | ACK SYN |cwnd 28160 csum 7183 urgent 0
Total 138

Pkt #189629613 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857159 ack 189629614 data_offset 8 flags | ACK |cwnd 229 csum 46942 urgent 0
Total 139

Pkt #1510857159 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857159 ack 189629614 data_offset 8 flags | ACK PSH |cwnd 229 csum 30608 urgent 0
Total 140

Pkt #1510857159 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("webpack-dev-server.badssl.com")
DEBUG: Result is Some(DNSName("webpack-dev-server.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 331 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 331
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47016 seq 189629614 ack 1510857490 data_offset 8 flags | ACK |cwnd 229 csum 46552 urgent 0
Total 141

Pkt #189629614 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47016 seq 189629614 ack 1510857490 data_offset 8 flags | ACK PSH |cwnd 229 csum 47009 urgent 0
Total 142

Pkt #189629614 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1269 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1269
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857490 ack 189630883 data_offset 8 flags | ACK |cwnd 248 csum 45198 urgent 0
Total 143

Pkt #1510857490 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857490 ack 189630883 data_offset 8 flags | ACK PSH |cwnd 248 csum 38870 urgent 0
Total 144

Pkt #1510857490 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 1510857490 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }
Matching server name
DNS name is : DNSName("webpack-dev-server.badssl.com")
DEBUG: Result is Some(DNSName("webpack-dev-server.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("webpack-dev-server.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([36, 5a, f8, d, bf, 8d, e3, fc, 85, 9e, d8, a5, 55, 0, 73, 70, 8f, 9a, f9, c1, 5, 2e, 80, 57, 41, 9b, 30, c8, 38, 1f, 7b, 2b]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("webpack-dev-server.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
DEBUG: cert count is 7
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47016 seq 189630883 ack 1510857616 data_offset 8 flags | ACK PSH |cwnd 229 csum 51723 urgent 0
Total 145

Pkt #189630883 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857616 ack 189631157 data_offset 8 flags | ACK PSH |cwnd 268 csum 53972 urgent 0
Total 146

Pkt #1510857616 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47016 seq 189631157 ack 1510857801 data_offset 8 flags | ACK PSH |cwnd 237 csum 33474 urgent 0
Total 147

Pkt #189631157 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857801 ack 189631948 data_offset 8 flags | ACK FIN |cwnd 288 csum 43550 urgent 0
Total 148

Pkt #1510857801 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47016 seq 189631948 ack 1510857802 data_offset 8 flags | ACK FIN |cwnd 237 csum 43539 urgent 0
Total 149

Pkt #189631948 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47016, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47016 dst_port 443 seq 1510857802 ack 189631949 data_offset 8 flags | ACK |cwnd 288 csum 43426 urgent 0
Total 150

Pkt #1510857802 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47016, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241024 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 43206 urgent 0
Total 151

Pkt #458241024 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47018 seq 769960546 ack 458241025 data_offset 10 flags | ACK SYN |cwnd 28160 csum 46575 urgent 0
Total 152

Pkt #769960546 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241025 ack 769960547 data_offset 8 flags | ACK |cwnd 229 csum 20793 urgent 0
Total 153

Pkt #458241025 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241025 ack 769960547 data_offset 8 flags | ACK PSH |cwnd 229 csum 34786 urgent 0
Total 154

Pkt #458241025 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("sha1-intermediate.badssl.com")
DEBUG: Result is Some(DNSName("sha1-intermediate.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 330 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 330
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47018 seq 769960547 ack 458241355 data_offset 8 flags | ACK |cwnd 229 csum 20405 urgent 0
Total 155

Pkt #769960547 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47018 seq 769960547 ack 458241355 data_offset 8 flags | ACK |cwnd 229 csum 41810 urgent 0
Total 156

Pkt #769960547 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241355 ack 769961895 data_offset 8 flags | ACK |cwnd 250 csum 18976 urgent 0
Total 157

Pkt #458241355 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47018 seq 769961895 ack 458241355 data_offset 8 flags | ACK |cwnd 229 csum 11956 urgent 0
Total 158

Pkt #769961895 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1348
Inserted
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241355 ack 769963243 data_offset 8 flags | ACK |cwnd 271 csum 17606 urgent 0
Total 159

Pkt #458241355 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47018 seq 769963243 ack 458241355 data_offset 8 flags | ACK PSH |cwnd 229 csum 36580 urgent 0
Total 160

Pkt #769963243 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 262
Inserted
reading size of 262 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 262

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241355 ack 769963505 data_offset 8 flags | ACK |cwnd 292 csum 17322 urgent 0
Total 161

Pkt #458241355 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241355 ack 769963505 data_offset 8 flags | ACK PSH |cwnd 292 csum 39502 urgent 0
Total 162

Pkt #458241355 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 458241355 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }
Matching server name
DNS name is : DNSName("sha1-intermediate.badssl.com")
DEBUG: Result is Some(DNSName("sha1-intermediate.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("sha1-intermediate.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([2d, 18, e3, 5a, a7, 81, 29, ab, 32, f, a1, 9b, 3a, e4, f9, bb, a3, 8c, 6b, c9, f9, da, 32, 29, 2c, d5, 1c, ac, 25, 3d, 22, eb]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("sha1-intermediate.badssl.com")

DEBUG: 
Oops, error: invalid certificate: UnknownIssuer
DEBUG: cert count is 8
DEBUG: Result of the cert validation is false
DEBUG: Certificate validation failed, both flows' connection need to be reset
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }

Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47018 seq 769963505 ack 458241481 data_offset 8 flags | ACK PSH |cwnd 229 csum 19362 urgent 0
Total 163

Pkt #769963505 belong to a unsafe flow!

Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 47018 dst_port 443 seq 458241481 ack 769963779 data_offset 8 flags | ACK PSH |cwnd 313 csum 25355 urgent 0
Total 164

Pkt #458241481 belong to a unsafe flow!

Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 } is marked as unsafe connection so we have to reset



TCP Headers: tcp src_port 443 dst_port 47018 seq 769963779 ack 458241665 data_offset 8 flags | ACK PSH |cwnd 237 csum 60171 urgent 0
Total 165

Pkt #769963779 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241665 ack 769964669 data_offset 8 flags | ACK FIN |cwnd 334 csum 15589 urgent 0
Total 166

Pkt #458241665 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47020 dst_port 443 seq 670655279 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 27608 urgent 0
Total 167

Pkt #670655279 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47020, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47018 seq 769964669 ack 458241666 data_offset 8 flags | ACK FIN |cwnd 237 csum 15634 urgent 0
Total 168

Pkt #769964669 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47018, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47018 dst_port 443 seq 458241666 ack 769964670 data_offset 8 flags | ACK |cwnd 334 csum 15486 urgent 0
Total 169

Pkt #458241666 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47018, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47020 seq 432430146 ack 670655280 data_offset 10 flags | ACK SYN |cwnd 28160 csum 55856 urgent 0
Total 170

Pkt #432430146 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47020, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47020 dst_port 443 seq 670655280 ack 432430147 data_offset 8 flags | ACK |cwnd 229 csum 30080 urgent 0
Total 171

Pkt #670655280 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47020, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47020 dst_port 443 seq 670655280 ack 432430147 data_offset 8 flags | ACK PSH |cwnd 229 csum 63609 urgent 0
Total 172

Pkt #670655280 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47020, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("rc4.badssl.com")
DEBUG: Result is Some(DNSName("rc4.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 316 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47020, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 316
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47020 seq 432430147 ack 670655596 data_offset 8 flags | ACK |cwnd 229 csum 29709 urgent 0
Total 173

Pkt #432430147 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47020, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47020 seq 432430147 ack 670655596 data_offset 8 flags | ACK PSH |cwnd 229 csum 12792 urgent 0
Total 174

Pkt #432430147 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47020, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47020 dst_port 443 seq 670655596 ack 432430154 data_offset 8 flags | ACK |cwnd 229 csum 29647 urgent 0
Total 175

Pkt #670655596 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47020, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47020 dst_port 443 seq 670655596 ack 432430154 data_offset 8 flags | ACK FIN |cwnd 229 csum 29645 urgent 0
Total 176

Pkt #670655596 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47020, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47020 seq 432430154 ack 670655596 data_offset 8 flags | ACK FIN |cwnd 229 csum 29700 urgent 0
Total 177

Pkt #432430154 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47020, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47020 dst_port 443 seq 670655597 ack 432430155 data_offset 8 flags | ACK |cwnd 229 csum 29644 urgent 0
Total 178

Pkt #670655597 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47020, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47020 seq 432430155 ack 670655597 data_offset 8 flags | ACK |cwnd 229 csum 29588 urgent 0
Total 179

Pkt #432430155 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47020, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47022 dst_port 443 seq 4107367933 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 35716 urgent 0
Total 180

Pkt #4107367933 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47022, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47022 seq 2081870463 ack 4107367934 data_offset 10 flags | ACK SYN |cwnd 28160 csum 8357 urgent 0
Total 181

Pkt #2081870463 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47022, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47022 dst_port 443 seq 4107367934 ack 2081870464 data_offset 8 flags | ACK |cwnd 229 csum 48117 urgent 0
Total 182

Pkt #4107367934 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47022, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47022 dst_port 443 seq 4107367934 ack 2081870464 data_offset 8 flags | ACK PSH |cwnd 229 csum 27273 urgent 0
Total 183

Pkt #4107367934 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47022, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("rc4-md5.badssl.com")
DEBUG: Result is Some(DNSName("rc4-md5.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 320 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47022, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 320
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47022 seq 2081870464 ack 4107368254 data_offset 8 flags | ACK |cwnd 229 csum 47741 urgent 0
Total 184

Pkt #2081870464 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47022, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47022 seq 2081870464 ack 4107368254 data_offset 8 flags | ACK PSH |cwnd 229 csum 30825 urgent 0
Total 185

Pkt #2081870464 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47022, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47022 dst_port 443 seq 4107368254 ack 2081870471 data_offset 8 flags | ACK |cwnd 229 csum 47680 urgent 0
Total 186

Pkt #4107368254 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47022, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47022 dst_port 443 seq 4107368254 ack 2081870471 data_offset 8 flags | ACK FIN |cwnd 229 csum 47679 urgent 0
Total 187

Pkt #4107368254 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47022, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47022 seq 2081870471 ack 4107368254 data_offset 8 flags | ACK FIN |cwnd 229 csum 47733 urgent 0
Total 188

Pkt #2081870471 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47022, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47022 dst_port 443 seq 4107368255 ack 2081870472 data_offset 8 flags | ACK |cwnd 229 csum 47676 urgent 0
Total 189

Pkt #4107368255 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47022, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47022 seq 2081870472 ack 4107368255 data_offset 8 flags | ACK |cwnd 229 csum 47627 urgent 0
Total 190

Pkt #2081870472 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47022, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244517884 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 51765 urgent 0
Total 191

Pkt #3244517884 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47024 seq 1513993371 ack 3244517885 data_offset 10 flags | ACK SYN |cwnd 28160 csum 40535 urgent 0
Total 192

Pkt #1513993371 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244517885 ack 1513993372 data_offset 8 flags | ACK |cwnd 229 csum 14760 urgent 0
Total 193

Pkt #3244517885 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244517885 ack 1513993372 data_offset 8 flags | ACK PSH |cwnd 229 csum 4440 urgent 0
Total 194

Pkt #3244517885 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("dh480.badssl.com")
DEBUG: Result is Some(DNSName("dh480.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 318 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 318
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47024 seq 1513993372 ack 3244518203 data_offset 8 flags | ACK |cwnd 229 csum 14387 urgent 0
Total 195

Pkt #1513993372 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47024 seq 1513993372 ack 3244518203 data_offset 8 flags | ACK |cwnd 229 csum 31661 urgent 0
Total 196

Pkt #1513993372 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244518203 ack 1513994720 data_offset 8 flags | ACK |cwnd 250 csum 12961 urgent 0
Total 197

Pkt #3244518203 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47024 seq 1513994720 ack 3244518203 data_offset 8 flags | ACK |cwnd 229 csum 23942 urgent 0
Total 198

Pkt #1513994720 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1348
Inserted
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244518203 ack 1513996068 data_offset 8 flags | ACK |cwnd 271 csum 11590 urgent 0
Total 199

Pkt #3244518203 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47024 seq 1513996068 ack 3244518203 data_offset 8 flags | ACK PSH |cwnd 229 csum 16506 urgent 0
Total 200

Pkt #1513996068 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 785
Inserted
reading size of 785 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47024, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 785

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244518203 ack 1513996853 data_offset 8 flags | ACK |cwnd 292 csum 10784 urgent 0
Total 201

Pkt #3244518203 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244518203 ack 1513996853 data_offset 8 flags | ACK PSH |cwnd 292 csum 59401 urgent 0
Total 202

Pkt #3244518203 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 7
Inserted
reading size of 7 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 7
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47024 dst_port 443 seq 3244518210 ack 1513996853 data_offset 8 flags | ACK RST |cwnd 292 csum 10771 urgent 0
Total 203

Pkt #3244518210 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47024, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744548 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 23694 urgent 0
Total 204

Pkt #2603744548 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47026 seq 2110127030 ack 2603744549 data_offset 10 flags | ACK SYN |cwnd 28160 csum 50524 urgent 0
Total 205

Pkt #2110127030 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744549 ack 2110127031 data_offset 8 flags | ACK |cwnd 229 csum 24748 urgent 0
Total 206

Pkt #2603744549 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744549 ack 2110127031 data_offset 8 flags | ACK PSH |cwnd 229 csum 22287 urgent 0
Total 207

Pkt #2603744549 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("dh512.badssl.com")
DEBUG: Result is Some(DNSName("dh512.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 318 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 318
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47026 seq 2110127031 ack 2603744867 data_offset 8 flags | ACK |cwnd 229 csum 24374 urgent 0
Total 208

Pkt #2110127031 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47026 seq 2110127031 ack 2603744867 data_offset 8 flags | ACK |cwnd 229 csum 19158 urgent 0
Total 209

Pkt #2110127031 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744867 ack 2110128379 data_offset 8 flags | ACK |cwnd 250 csum 22948 urgent 0
Total 210

Pkt #2603744867 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47026 seq 2110128379 ack 2603744867 data_offset 8 flags | ACK |cwnd 229 csum 33929 urgent 0
Total 211

Pkt #2110128379 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1348
Inserted
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744867 ack 2110129727 data_offset 8 flags | ACK |cwnd 271 csum 21577 urgent 0
Total 212

Pkt #2603744867 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47026 seq 2110129727 ack 2603744867 data_offset 8 flags | ACK PSH |cwnd 229 csum 63796 urgent 0
Total 213

Pkt #2110129727 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 793
Inserted
reading size of 793 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47026, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 793

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744867 ack 2110130520 data_offset 8 flags | ACK |cwnd 292 csum 20762 urgent 0
Total 214

Pkt #2603744867 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744867 ack 2110130520 data_offset 8 flags | ACK PSH |cwnd 292 csum 3844 urgent 0
Total 215

Pkt #2603744867 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 7
Inserted
reading size of 7 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 7
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47026 dst_port 443 seq 2603744874 ack 2110130520 data_offset 8 flags | ACK RST |cwnd 292 csum 20749 urgent 0
Total 216

Pkt #2603744874 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47026, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47028 dst_port 443 seq 15769857 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 21057 urgent 0
Total 217

Pkt #15769857 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283446571 ack 15769858 data_offset 10 flags | ACK SYN |cwnd 28160 csum 2710 urgent 0
Total 218

Pkt #2283446571 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47028 dst_port 443 seq 15769858 ack 2283446572 data_offset 8 flags | ACK |cwnd 229 csum 42469 urgent 0
Total 219

Pkt #15769858 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47028 dst_port 443 seq 15769858 ack 2283446572 data_offset 8 flags | ACK PSH |cwnd 229 csum 42544 urgent 0
Total 220

Pkt #15769858 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("dh1024.badssl.com")
DEBUG: Result is Some(DNSName("dh1024.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 319 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 319
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283446572 ack 15770177 data_offset 8 flags | ACK |cwnd 229 csum 42094 urgent 0
Total 221

Pkt #2283446572 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283447920 ack 15770177 data_offset 8 flags | ACK |cwnd 229 csum 51648 urgent 0
Total 222

Pkt #2283447920 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47028 dst_port 443 seq 15770177 ack 2283446572 data_offset 11 flags | ACK |cwnd 250 csum 2991 urgent 0
Total 223

Pkt #15770177 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283449268 ack 15770177 data_offset 8 flags | ACK PSH |cwnd 229 csum 2185 urgent 0
Total 224

Pkt #2283449268 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47028 dst_port 443 seq 15770177 ack 2283446572 data_offset 11 flags | ACK |cwnd 264 csum 2056 urgent 0
Total 225

Pkt #15770177 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283446572 ack 15770177 data_offset 8 flags | ACK |cwnd 229 csum 40750 urgent 0
Total 226

Pkt #2283446572 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47028 dst_port 443 seq 15770177 ack 2283450189 data_offset 8 flags | ACK |cwnd 285 csum 38362 urgent 0
Total 227

Pkt #15770177 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47028 dst_port 443 seq 15770177 ack 2283450189 data_offset 8 flags | ACK PSH |cwnd 285 csum 3040 urgent 0
Total 228

Pkt #15770177 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 190
Inserted
reading size of 190 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 190
is Client Key Exchange

important: Pkt 15770177 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }
Matching server name
DNS name is : DNSName("dh1024.badssl.com")
DEBUG: Result is Some(DNSName("dh1024.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("dh1024.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([fc, 84, a5, 93, 38, bd, e7, ca, fc, 19, e, a7, e5, 18, 3c, 84, 3, f7, 27, 41, 56, 74, ec, b2, a1, 5e, b4, 84, 5, 41, ab, a8]), session_id: SessionID, cipher_suite: TLS_DHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), SessionTicketAck] }

And the magic number is 62


ON FRAME: Read bytes but got None
DEBUG: Get None, abort

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }
DEBUG: error: CertificateNotExtractedError
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283450189 ack 15770367 data_offset 8 flags | ACK PSH |cwnd 237 csum 1610 urgent 0
Total 229

Pkt #2283450189 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
not Client Key Exchange
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47028 dst_port 443 seq 15770367 ack 2283450447 data_offset 8 flags | ACK PSH |cwnd 306 csum 27474 urgent 0
Total 230

Pkt #15770367 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 173
Inserted
reading size of 173 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 173
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283450447 ack 15770540 data_offset 8 flags | ACK PSH |cwnd 246 csum 56882 urgent 0
Total 231

Pkt #2283450447 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47028 dst_port 443 seq 15770540 ack 2283451316 data_offset 8 flags | ACK FIN |cwnd 327 csum 36623 urgent 0
Total 232

Pkt #15770540 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47028 seq 2283451316 ack 15770541 data_offset 8 flags | ACK FIN |cwnd 246 csum 36649 urgent 0
Total 233

Pkt #2283451316 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47028, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47028 dst_port 443 seq 15770541 ack 2283451317 data_offset 8 flags | ACK |cwnd 327 csum 36516 urgent 0
Total 234

Pkt #15770541 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47028, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47030 dst_port 443 seq 2235471961 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 54656 urgent 0
Total 235

Pkt #2235471961 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47030, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47030 seq 2514540807 ack 2235471962 data_offset 10 flags | ACK SYN |cwnd 28160 csum 18203 urgent 0
Total 236

Pkt #2514540807 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47030, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47030 dst_port 443 seq 2235471962 ack 2514540808 data_offset 8 flags | ACK |cwnd 229 csum 57962 urgent 0
Total 237

Pkt #2235471962 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47030, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47030 dst_port 443 seq 2235471962 ack 2514540808 data_offset 8 flags | ACK PSH |cwnd 229 csum 48856 urgent 0
Total 238

Pkt #2235471962 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47030, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("null.badssl.com")
DEBUG: Result is Some(DNSName("null.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 317 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47030, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 317
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47030 seq 2514540808 ack 2235472279 data_offset 8 flags | ACK |cwnd 229 csum 57586 urgent 0
Total 239

Pkt #2514540808 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47030, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47030 seq 2514540808 ack 2235472279 data_offset 8 flags | ACK PSH |cwnd 229 csum 40669 urgent 0
Total 240

Pkt #2514540808 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47030, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47030 dst_port 443 seq 2235472279 ack 2514540815 data_offset 8 flags | ACK |cwnd 229 csum 57519 urgent 0
Total 241

Pkt #2235472279 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47030, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47030 seq 2514540815 ack 2235472279 data_offset 8 flags | ACK FIN |cwnd 229 csum 57577 urgent 0
Total 242

Pkt #2514540815 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47030, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47030 dst_port 443 seq 2235472279 ack 2514540816 data_offset 8 flags | ACK FIN |cwnd 229 csum 57517 urgent 0
Total 243

Pkt #2235472279 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47030, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47030 seq 2514540816 ack 2235472280 data_offset 8 flags | ACK |cwnd 229 csum 57464 urgent 0
Total 244

Pkt #2514540816 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47030, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831123567 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 51921 urgent 0
Total 245

Pkt #1831123567 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47032 seq 2954090037 ack 1831123568 data_offset 10 flags | ACK SYN |cwnd 28160 csum 9307 urgent 0
Total 246

Pkt #2954090037 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831123568 ack 2954090038 data_offset 8 flags | ACK |cwnd 229 csum 49067 urgent 0
Total 247

Pkt #1831123568 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831123568 ack 2954090038 data_offset 8 flags | ACK PSH |cwnd 229 csum 59115 urgent 0
Total 248

Pkt #1831123568 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("tls-v1-0.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-0.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 321 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 321
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47032 seq 2954090038 ack 1831123889 data_offset 8 flags | ACK |cwnd 229 csum 48685 urgent 0
Total 249

Pkt #2954090038 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47032 seq 2954090038 ack 1831123889 data_offset 8 flags | ACK |cwnd 229 csum 1845 urgent 0
Total 250

Pkt #2954090038 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831123889 ack 2954091386 data_offset 8 flags | ACK |cwnd 250 csum 47254 urgent 0
Total 251

Pkt #1831123889 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831123889 ack 2954093469 data_offset 8 flags | ACK |cwnd 282 csum 45136 urgent 0
Total 252

Pkt #1831123889 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831123889 ack 2954093469 data_offset 8 flags | ACK PSH |cwnd 282 csum 1898 urgent 0
Total 253

Pkt #1831123889 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 1831123889 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }
Matching server name
DNS name is : DNSName("tls-v1-0.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-0.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("tls-v1-0.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([88, dd, f8, 2d, b6, df, 21, e0, be, dc, c0, 55, 61, 9c, 5d, 62, af, 4e, de, c7, 7c, a4, 34, 61, 35, bf, 5b, 5a, aa, 40, b0, 43]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70


ON FRAME: Read bytes but got None
DEBUG: Get None, abort

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }
DEBUG: error: CertificateNotExtractedError
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47032 seq 2954093469 ack 1831124015 data_offset 8 flags | ACK PSH |cwnd 229 csum 65144 urgent 0
Total 254

Pkt #2954093469 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
not Client Key Exchange
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831124015 ack 2954093727 data_offset 8 flags | ACK PSH |cwnd 303 csum 63860 urgent 0
Total 255

Pkt #1831124015 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 175
Inserted
reading size of 175 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 175
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47032 seq 2954093727 ack 1831124190 data_offset 8 flags | ACK PSH |cwnd 237 csum 63302 urgent 0
Total 256

Pkt #2954093727 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208306333 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 12940 urgent 0
Total 257

Pkt #208306333 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831124190 ack 2954094167 data_offset 8 flags | ACK |cwnd 324 csum 43842 urgent 0
Total 258

Pkt #1831124190 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1010 dst_port 59254 seq 2461531259 ack 208306334 data_offset 10 flags | ACK SYN |cwnd 28160 csum 33359 urgent 0
Total 259

Pkt #2461531259 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208306334 ack 2461531260 data_offset 8 flags | ACK |cwnd 229 csum 7585 urgent 0
Total 260

Pkt #208306334 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208306334 ack 2461531260 data_offset 8 flags | ACK PSH |cwnd 229 csum 57509 urgent 0
Total 261

Pkt #208306334 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("tls-v1-0.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-0.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 321 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 321
      4: This packet is inserted, quack


TCP Headers: tcp src_port 1010 dst_port 59254 seq 2461531260 ack 208306655 data_offset 8 flags | ACK |cwnd 229 csum 7210 urgent 0
Total 262

Pkt #2461531260 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 1010 dst_port 59254 seq 2461531260 ack 208306655 data_offset 8 flags | ACK |cwnd 229 csum 65522 urgent 0
Total 263

Pkt #2461531260 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208306655 ack 2461532608 data_offset 8 flags | ACK |cwnd 250 csum 5786 urgent 0
Total 264

Pkt #208306655 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208306655 ack 2461534689 data_offset 8 flags | ACK |cwnd 282 csum 3672 urgent 0
Total 265

Pkt #208306655 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208306655 ack 2461534689 data_offset 8 flags | ACK PSH |cwnd 282 csum 63552 urgent 0
Total 266

Pkt #208306655 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 134
Inserted
reading size of 134 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 134
is Client Key Exchange

important: Pkt 208306655 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }
Matching server name
DNS name is : DNSName("tls-v1-0.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-0.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("tls-v1-0.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_0, random: Random([5f, e2, a9, d5, 5a, 99, d2, 64, e3, 49, 9, 77, 2, f, aa, bc, 17, bf, 6c, 33, e0, 83, 92, 3a, 3f, fe, c7, c6, ca, 6d, 82, fb]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70


ON FRAME: Read bytes but got None
DEBUG: Get None, abort

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }
DEBUG: error: CertificateNotExtractedError
Ok
Ok


TCP Headers: tcp src_port 1010 dst_port 59254 seq 2461534689 ack 208306789 data_offset 8 flags | ACK PSH |cwnd 237 csum 30005 urgent 0
Total 267

Pkt #2461534689 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
not Client Key Exchange
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208306789 ack 2461534955 data_offset 8 flags | ACK PSH |cwnd 303 csum 21839 urgent 0
Total 268

Pkt #208306789 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 218
Inserted
reading size of 218 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 218
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1010 dst_port 59254 seq 2461534955 ack 208307007 data_offset 8 flags | ACK PSH |cwnd 246 csum 59324 urgent 0
Total 269

Pkt #2461534955 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831124190 ack 2954094167 data_offset 8 flags | ACK PSH |cwnd 324 csum 64041 urgent 0
Total 270

Pkt #1831124190 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 31
Inserted
reading size of 31 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 31
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831124221 ack 2954094167 data_offset 8 flags | ACK FIN |cwnd 324 csum 43636 urgent 0
Total 271

Pkt #1831124221 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208307007 ack 2461535728 data_offset 8 flags | ACK FIN |cwnd 324 csum 2019 urgent 0
Total 272

Pkt #208307007 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47032 seq 2954094167 ack 1831124221 data_offset 8 flags | ACK FIN |cwnd 237 csum 43464 urgent 0
Total 273

Pkt #2954094167 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47032 dst_port 443 seq 1831124222 ack 2954094168 data_offset 8 flags | ACK |cwnd 324 csum 43328 urgent 0
Total 274

Pkt #1831124222 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47032, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494085616 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 40005 urgent 0
Total 275

Pkt #3494085616 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47032 seq 2954094168 ack 1831124222 data_offset 8 flags | ACK |cwnd 237 csum 43458 urgent 0
Total 276

Pkt #2954094168 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47032, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1010 dst_port 59254 seq 2461535728 ack 208307008 data_offset 8 flags | ACK FIN |cwnd 246 csum 2040 urgent 0
Total 277

Pkt #2461535728 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 59254, dst_port: 1010, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 59254 dst_port 1010 seq 208307008 ack 2461535729 data_offset 8 flags | ACK |cwnd 324 csum 1908 urgent 0
Total 278

Pkt #208307008 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1010, dst_port: 59254, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47036 seq 2374448016 ack 3494085617 data_offset 10 flags | ACK SYN |cwnd 28160 csum 47377 urgent 0
Total 279

Pkt #2374448016 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494085617 ack 2374448017 data_offset 8 flags | ACK |cwnd 229 csum 21595 urgent 0
Total 280

Pkt #3494085617 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494085617 ack 2374448017 data_offset 8 flags | ACK PSH |cwnd 229 csum 29334 urgent 0
Total 281

Pkt #3494085617 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("tls-v1-1.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-1.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 321 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 321
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47036 seq 2374448017 ack 3494085938 data_offset 8 flags | ACK |cwnd 229 csum 21218 urgent 0
Total 282

Pkt #2374448017 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47036 seq 2374448017 ack 3494085938 data_offset 8 flags | ACK |cwnd 229 csum 41090 urgent 0
Total 283

Pkt #2374448017 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494085938 ack 2374449365 data_offset 8 flags | ACK |cwnd 250 csum 19792 urgent 0
Total 284

Pkt #3494085938 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494085938 ack 2374451448 data_offset 8 flags | ACK |cwnd 282 csum 17675 urgent 0
Total 285

Pkt #3494085938 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494085938 ack 2374451448 data_offset 8 flags | ACK PSH |cwnd 282 csum 59773 urgent 0
Total 286

Pkt #3494085938 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 3494085938 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }
Matching server name
DNS name is : DNSName("tls-v1-1.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-1.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("tls-v1-1.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([f7, 99, 87, 38, 4a, 68, d3, 2c, fc, 9, 6a, d2, 9a, f2, 24, e1, 40, ae, d3, 2e, 23, 6e, ec, d6, 21, 4, 7f, 89, 83, 9d, 1e, 4d]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70


ON FRAME: Read bytes but got None
DEBUG: Get None, abort

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }
DEBUG: error: CertificateNotExtractedError
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47036 seq 2374451448 ack 3494086064 data_offset 8 flags | ACK PSH |cwnd 229 csum 57573 urgent 0
Total 287

Pkt #2374451448 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
not Client Key Exchange
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494086064 ack 2374451706 data_offset 8 flags | ACK PSH |cwnd 303 csum 59317 urgent 0
Total 288

Pkt #3494086064 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 175
Inserted
reading size of 175 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 175
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47036 seq 2374451706 ack 3494086239 data_offset 8 flags | ACK PSH |cwnd 237 csum 8495 urgent 0
Total 289

Pkt #2374451706 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365156 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 19963 urgent 0
Total 290

Pkt #2340365156 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494086239 ack 2374452146 data_offset 8 flags | ACK |cwnd 324 csum 16386 urgent 0
Total 291

Pkt #3494086239 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143400596 ack 2340365157 data_offset 10 flags | ACK SYN |cwnd 28160 csum 63669 urgent 0
Total 292

Pkt #2143400596 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365157 ack 2143400597 data_offset 8 flags | ACK |cwnd 229 csum 37893 urgent 0
Total 293

Pkt #2340365157 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365157 ack 2143400597 data_offset 8 flags | ACK PSH |cwnd 229 csum 42557 urgent 0
Total 294

Pkt #2340365157 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("tls-v1-1.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-1.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 321 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 321
      4: This packet is inserted, quack


TCP Headers: tcp src_port 44790 dst_port 443 seq 829828864 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 7761 urgent 0
Total 295

Pkt #829828864 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143400597 ack 2340365478 data_offset 8 flags | ACK |cwnd 229 csum 37514 urgent 0
Total 296

Pkt #2143400597 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143400597 ack 2340365478 data_offset 8 flags | ACK |cwnd 229 csum 43267 urgent 0
Total 297

Pkt #2143400597 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365478 ack 2143401945 data_offset 8 flags | ACK |cwnd 250 csum 36086 urgent 0
Total 298

Pkt #2340365478 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143401945 ack 2340365478 data_offset 8 flags | ACK |cwnd 229 csum 55301 urgent 0
Total 299

Pkt #2143401945 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 1348
Inserted
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365478 ack 2143403293 data_offset 8 flags | ACK |cwnd 271 csum 34715 urgent 0
Total 300

Pkt #2340365478 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143403293 ack 2340365478 data_offset 8 flags | ACK PSH |cwnd 229 csum 7053 urgent 0
Total 301

Pkt #2143403293 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 733
Inserted
reading size of 733 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 733
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365478 ack 2143404026 data_offset 8 flags | ACK |cwnd 292 csum 33961 urgent 0
Total 302

Pkt #2340365478 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365478 ack 2143404026 data_offset 8 flags | ACK PSH |cwnd 292 csum 23836 urgent 0
Total 303

Pkt #2340365478 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 150
Inserted
reading size of 150 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 150
is Client Key Exchange

important: Pkt 2340365478 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }
Matching server name
DNS name is : DNSName("tls-v1-1.badssl.com")
DEBUG: Result is Some(DNSName("tls-v1-1.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("tls-v1-1.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_1, random: Random([c2, ea, b9, 70, 90, f, f0, d0, f2, 1e, c0, 0, cd, 23, 4e, 7f, c6, fc, 99, d8, 79, 87, 2, 87, bd, cf, 27, 87, fe, c1, df, f0]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70

Parsing the certificate payload..

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

Testing our cert

DEBUG: validate certs

dns name is DNSName("tls-v1-1.badssl.com")

DEBUG: 
It worked!!!
DEBUG: cert count is 9
DEBUG: Result of the cert validation is true
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103744153 ack 829828865 data_offset 10 flags | ACK SYN |cwnd 28480 csum 23905 urgent 0
Total 304

Pkt #2103744153 is Vacant

And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 44790 dst_port 443 seq 829828865 ack 2103744154 data_offset 8 flags | ACK |cwnd 229 csum 64006 urgent 0
Total 305

Pkt #829828865 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 44790 dst_port 443 seq 829828865 ack 2103744154 data_offset 8 flags | ACK PSH |cwnd 229 csum 45224 urgent 0
Total 306

Pkt #829828865 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("api.github.com")
DEBUG: Result is Some(DNSName("api.github.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 517 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 517
      4: This packet is inserted, quack


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143404026 ack 2340365628 data_offset 8 flags | ACK PSH |cwnd 237 csum 23075 urgent 0
Total 307

Pkt #2143404026 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 282
Inserted
reading size of 282 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 282
not Client Key Exchange
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365628 ack 2143404308 data_offset 8 flags | ACK PSH |cwnd 313 csum 51351 urgent 0
Total 308

Pkt #2340365628 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 197
Inserted
reading size of 197 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 197
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103744154 ack 829829382 data_offset 8 flags | ACK |cwnd 29 csum 28246 urgent 0
Total 309

Pkt #2103744154 is Vacant

And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829382 ack 2103745502 data_offset 8 flags | ACK |cwnd 250 csum 62054 urgent 0
Total 310

Pkt #829829382 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829382 ack 2103747555 data_offset 8 flags | ACK |cwnd 282 csum 59967 urgent 0
Total 311

Pkt #829829382 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829382 ack 2103747555 data_offset 8 flags | ACK PSH |cwnd 282 csum 21410 urgent 0
Total 312

Pkt #829829382 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 64
Inserted
reading size of 64 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 64
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829446 ack 2103747555 data_offset 8 flags | ACK PSH |cwnd 282 csum 35674 urgent 0
Total 313

Pkt #829829446 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 207
Inserted
reading size of 207 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 207
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103747555 ack 829829653 data_offset 8 flags | ACK PSH |cwnd 30 csum 34661 urgent 0
Total 314

Pkt #2103747555 is Occupied!
And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103747634 ack 829829653 data_offset 8 flags | ACK PSH |cwnd 30 csum 49037 urgent 0
Total 315

Pkt #2103747634 is Occupied!
And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829653 ack 2103747713 data_offset 8 flags | ACK |cwnd 282 csum 59503 urgent 0
Total 316

Pkt #829829653 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143404308 ack 2340365825 data_offset 8 flags | ACK PSH |cwnd 246 csum 40419 urgent 0
Total 317

Pkt #2143404308 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 789
Inserted
reading size of 789 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 789
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494086239 ack 2374452146 data_offset 8 flags | ACK PSH |cwnd 324 csum 23084 urgent 0
Total 318

Pkt #3494086239 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 31
Inserted
reading size of 31 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 31
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494086270 ack 2374452146 data_offset 8 flags | ACK FIN |cwnd 324 csum 16184 urgent 0
Total 319

Pkt #3494086270 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103747713 ack 829829653 data_offset 8 flags | ACK PSH |cwnd 30 csum 21908 urgent 0
Total 320

Pkt #2103747713 is Occupied!
And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829653 ack 2103748714 data_offset 8 flags | ACK PSH |cwnd 303 csum 38416 urgent 0
Total 321

Pkt #829829653 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 24
Inserted
reading size of 24 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 24
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365825 ack 2143405097 data_offset 8 flags | ACK FIN |cwnd 334 csum 32293 urgent 0
Total 322

Pkt #2340365825 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829677 ack 2103748714 data_offset 8 flags | ACK FIN |cwnd 303 csum 58436 urgent 0
Total 323

Pkt #829829677 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103748714 ack 829829677 data_offset 8 flags | ACK PSH |cwnd 30 csum 55765 urgent 0
Total 324

Pkt #2103748714 is Occupied!
And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829677 ack 0 data_offset 5 flags | RST |cwnd 0 csum 7632 urgent 0
Total 325

Pkt #829829677 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 6
Inserted
reading size of 6 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 6
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103748738 ack 829829677 data_offset 8 flags | ACK FIN |cwnd 30 csum 58683 urgent 0
Total 326

Pkt #2103748738 is Occupied!
And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829677 ack 0 data_offset 5 flags | RST |cwnd 0 csum 7632 urgent 0
Total 327

Pkt #829829677 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 44790 seq 2103748739 ack 829829678 data_offset 8 flags | ACK |cwnd 30 csum 58676 urgent 0
Total 328

Pkt #2103748739 is Occupied!
And the flow is: Flow { src_ip: 3223256436, dst_ip: 2886997012, src_port: 44790, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 44790 dst_port 443 seq 829829678 ack 0 data_offset 5 flags | RST |cwnd 0 csum 7631 urgent 0
Total 329

Pkt #829829678 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 1
Inserted
reading size of 1 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 3223256436, src_port: 443, dst_port: 44790, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47036 seq 2374452146 ack 3494086270 data_offset 8 flags | ACK FIN |cwnd 237 csum 16013 urgent 0
Total 330

Pkt #2374452146 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47036 dst_port 443 seq 3494086271 ack 2374452147 data_offset 8 flags | ACK |cwnd 324 csum 15878 urgent 0
Total 331

Pkt #3494086271 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47036, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47036 seq 2374452147 ack 3494086271 data_offset 8 flags | ACK |cwnd 237 csum 16008 urgent 0
Total 332

Pkt #2374452147 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47036, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 1011 dst_port 43078 seq 2143405097 ack 2340365826 data_offset 8 flags | ACK FIN |cwnd 246 csum 32326 urgent 0
Total 333

Pkt #2143405097 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 43078, dst_port: 1011, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 43078 dst_port 1011 seq 2340365826 ack 2143405098 data_offset 8 flags | ACK |cwnd 334 csum 32186 urgent 0
Total 334

Pkt #2340365826 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 1011, dst_port: 43078, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906286837 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 56306 urgent 0
Total 335

Pkt #1906286837 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 48756 dst_port 443 seq 4180758946 ack 1666171581 data_offset 8 flags | ACK PSH |cwnd 1444 csum 3066 urgent 0
Total 336

Pkt #4180758946 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 316097268, src_port: 443, dst_port: 48756, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 443 dst_port 47042 seq 3341294934 ack 1906286838 data_offset 10 flags | ACK SYN |cwnd 28160 csum 54130 urgent 0
Total 337

Pkt #3341294934 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906286838 ack 3341294935 data_offset 8 flags | ACK |cwnd 229 csum 28355 urgent 0
Total 338

Pkt #1906286838 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906286838 ack 3341294935 data_offset 8 flags | ACK PSH |cwnd 229 csum 34945 urgent 0
Total 339

Pkt #1906286838 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("cbc.badssl.com")
DEBUG: Result is Some(DNSName("cbc.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 316 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 316
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 48756 seq 1666171581 ack 4180759009 data_offset 8 flags | ACK |cwnd 10 csum 23504 urgent 0
Total 340

Pkt #1666171581 is Vacant

And the flow is: Flow { src_ip: 316097268, dst_ip: 2886997012, src_port: 48756, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 48756 seq 1666171581 ack 4180759009 data_offset 8 flags | ACK PSH |cwnd 10 csum 32192 urgent 0
Total 341

Pkt #1666171581 is Vacant

And the flow is: Flow { src_ip: 316097268, dst_ip: 2886997012, src_port: 48756, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 48756 dst_port 443 seq 4180759009 ack 1666171644 data_offset 8 flags | ACK |cwnd 1444 csum 21977 urgent 0
Total 342

Pkt #4180759009 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 316097268, src_port: 443, dst_port: 48756, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47042 seq 3341294935 ack 1906287154 data_offset 8 flags | ACK |cwnd 229 csum 27986 urgent 0
Total 343

Pkt #3341294935 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47042 seq 3341294935 ack 1906287154 data_offset 8 flags | ACK |cwnd 229 csum 30252 urgent 0
Total 344

Pkt #3341294935 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 }
not client hello
not client hello
is server hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 1348 payload into the flow entry 
Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 1348
      4: This packet is inserted, quack


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906287154 ack 3341296283 data_offset 8 flags | ACK |cwnd 250 csum 26563 urgent 0
Total 345

Pkt #1906287154 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906287154 ack 3341298366 data_offset 8 flags | ACK |cwnd 282 csum 24447 urgent 0
Total 346

Pkt #1906287154 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906287154 ack 3341298366 data_offset 8 flags | ACK PSH |cwnd 282 csum 61930 urgent 0
Total 347

Pkt #1906287154 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 182
Inserted
reading size of 182 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 182
is Client Key Exchange

important: Pkt 1906287154 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }
Matching server name
DNS name is : DNSName("cbc.badssl.com")
DEBUG: Result is Some(DNSName("cbc.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("cbc.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 }

DEBUG: entering and then parsing the huge payload 

ServerHello
ServerHelloPayload { legacy_version: TLSv1_2, random: Random([e6, ea, d, 58, 9e, 34, 2e, e5, 19, a3, 54, b1, 2a, 3a, 1f, 29, 4d, da, 9d, 8a, b3, 67, 7, 3, 59, 93, ee, f, 5b, 19, 35, 56]), session_id: SessionID, cipher_suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384, compression_method: Null, extensions: [ServerNameAck, RenegotiationInfo(PayloadU8([])), ECPointFormats([Uncompressed, ANSIX962CompressedPrime, ANSIX962CompressedChar2]), SessionTicketAck] }

And the magic number is 70


ON FRAME: Read bytes but got None
DEBUG: Get None, abort

DEBUG: We now retrieve the certs from the tcp payload

DEBUG: flow is Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }
DEBUG: error: CertificateNotExtractedError
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47042 seq 3341298366 ack 1906287336 data_offset 8 flags | ACK PSH |cwnd 237 csum 50713 urgent 0
Total 348

Pkt #3341298366 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
not Client Key Exchange
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906287336 ack 3341298680 data_offset 8 flags | ACK PSH |cwnd 303 csum 62165 urgent 0
Total 349

Pkt #1906287336 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 213
Inserted
reading size of 213 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 213
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47042 seq 3341298680 ack 1906287549 data_offset 8 flags | ACK PSH |cwnd 246 csum 22415 urgent 0
Total 350

Pkt #3341298680 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 0
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906287549 ack 3341299485 data_offset 8 flags | ACK FIN |cwnd 324 csum 22676 urgent 0
Total 351

Pkt #1906287549 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47042 seq 3341299485 ack 1906287550 data_offset 8 flags | ACK FIN |cwnd 246 csum 22700 urgent 0
Total 352

Pkt #3341299485 is Occupied!
And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47042, dst_port: 443, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47042 dst_port 443 seq 1906287550 ack 3341299486 data_offset 8 flags | ACK |cwnd 324 csum 22571 urgent 0
Total 353

Pkt #1906287550 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47042, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47044 dst_port 443 seq 1270049021 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 14531 urgent 0
Total 354

Pkt #1270049021 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47044, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47044 seq 1111021570 ack 1270049022 data_offset 10 flags | ACK SYN |cwnd 28160 csum 63858 urgent 0
Total 355

Pkt #1111021570 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47044, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47044 dst_port 443 seq 1270049022 ack 1111021571 data_offset 8 flags | ACK |cwnd 229 csum 38081 urgent 0
Total 356

Pkt #1270049022 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47044, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47044 dst_port 443 seq 1270049022 ack 1111021571 data_offset 8 flags | ACK PSH |cwnd 229 csum 20441 urgent 0
Total 357

Pkt #1270049022 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47044, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("3des.badssl.com")
DEBUG: Result is Some(DNSName("3des.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 317 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47044, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 317
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47044 seq 1111021571 ack 1270049339 data_offset 8 flags | ACK |cwnd 229 csum 37709 urgent 0
Total 358

Pkt #1111021571 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47044, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47044 seq 1111021571 ack 1270049339 data_offset 8 flags | ACK PSH |cwnd 229 csum 20793 urgent 0
Total 359

Pkt #1111021571 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47044, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47044 dst_port 443 seq 1270049339 ack 1111021578 data_offset 8 flags | ACK |cwnd 229 csum 37647 urgent 0
Total 360

Pkt #1270049339 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47044, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47044 dst_port 443 seq 1270049339 ack 1111021578 data_offset 8 flags | ACK FIN |cwnd 229 csum 37646 urgent 0
Total 361

Pkt #1270049339 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47044, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47044 seq 1111021578 ack 1270049339 data_offset 8 flags | ACK FIN |cwnd 229 csum 37701 urgent 0
Total 362

Pkt #1111021578 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47044, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47044 dst_port 443 seq 1270049340 ack 1111021579 data_offset 8 flags | ACK |cwnd 229 csum 37644 urgent 0
Total 363

Pkt #1270049340 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47044, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47044 seq 1111021579 ack 1270049340 data_offset 8 flags | ACK |cwnd 229 csum 37589 urgent 0
Total 364

Pkt #1111021579 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47044, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246093394 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 48271 urgent 0
Total 365

Pkt #2246093394 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47046 seq 3867029486 ack 2246093395 data_offset 10 flags | ACK SYN |cwnd 28160 csum 32865 urgent 0
Total 366

Pkt #3867029486 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246093395 ack 3867029487 data_offset 8 flags | ACK |cwnd 229 csum 7091 urgent 0
Total 367

Pkt #2246093395 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246093395 ack 3867029487 data_offset 8 flags | ACK PSH |cwnd 229 csum 52758 urgent 0
Total 368

Pkt #2246093395 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("revoked.badssl.com")
DEBUG: Result is Some(DNSName("revoked.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 320 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 320
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47046 seq 3867029487 ack 2246093715 data_offset 8 flags | ACK |cwnd 229 csum 6714 urgent 0
Total 369

Pkt #3867029487 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47046 seq 3867032183 ack 2246093715 data_offset 8 flags | ACK PSH |cwnd 229 csum 63105 urgent 0
Total 370

Pkt #3867032183 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246093715 ack 3867029487 data_offset 11 flags | ACK |cwnd 238 csum 40842 urgent 0
Total 371

Pkt #2246093715 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246093715 ack 3867032799 data_offset 8 flags | ACK |cwnd 280 csum 3290 urgent 0
Total 372

Pkt #2246093715 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246093715 ack 3867032799 data_offset 8 flags | ACK PSH |cwnd 280 csum 1841 urgent 0
Total 373

Pkt #2246093715 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 2246093715 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }
Matching server name
DNS name is : DNSName("revoked.badssl.com")
DEBUG: Result is Some(DNSName("revoked.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("revoked.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 }
DEBUG: We had a problem: the entry of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 } doesn't exist
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47046 seq 3867032799 ack 2246093841 data_offset 8 flags | ACK PSH |cwnd 229 csum 18419 urgent 0
Total 374

Pkt #3867032799 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 }
not client hello
not client hello
not server hello


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246093841 ack 3867033057 data_offset 8 flags | ACK PSH |cwnd 301 csum 61813 urgent 0
Total 375

Pkt #2246093841 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 174
Inserted
reading size of 174 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 174
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47046 seq 3867033057 ack 2246094015 data_offset 8 flags | ACK PSH |cwnd 237 csum 944 urgent 0
Total 376

Pkt #3867033057 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246094015 ack 3867033908 data_offset 8 flags | ACK FIN |cwnd 322 csum 1629 urgent 0
Total 377

Pkt #2246094015 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47046 seq 3867033908 ack 2246094016 data_offset 8 flags | ACK FIN |cwnd 237 csum 1662 urgent 0
Total 378

Pkt #3867033908 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47046, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47046 dst_port 443 seq 2246094016 ack 3867033909 data_offset 8 flags | ACK |cwnd 322 csum 1527 urgent 0
Total 379

Pkt #2246094016 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47046, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511143 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 16178 urgent 0
Total 380

Pkt #374511143 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47048 seq 3469100209 ack 374511144 data_offset 10 flags | ACK SYN |cwnd 28160 csum 1251 urgent 0
Total 381

Pkt #3469100209 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47048, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511144 ack 3469100210 data_offset 8 flags | ACK |cwnd 229 csum 41011 urgent 0
Total 382

Pkt #374511144 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511144 ack 3469100210 data_offset 8 flags | ACK PSH |cwnd 229 csum 14761 urgent 0
Total 383

Pkt #374511144 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("pinning-test.badssl.com")
DEBUG: Result is Some(DNSName("pinning-test.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 325 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 325
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47048 seq 3469100210 ack 374511469 data_offset 8 flags | ACK |cwnd 229 csum 40628 urgent 0
Total 384

Pkt #3469100210 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47048, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511469 ack 3469103641 data_offset 8 flags | ACK |cwnd 282 csum 37084 urgent 0
Total 385

Pkt #374511469 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511469 ack 3469103641 data_offset 8 flags | ACK PSH |cwnd 282 csum 8258 urgent 0
Total 386

Pkt #374511469 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 126
Inserted
reading size of 126 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 126
is Client Key Exchange

important: Pkt 374511469 is a client key exchange

Try to get the dns name from the entry of the Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }
Matching server name
DNS name is : DNSName("pinning-test.badssl.com")
DEBUG: Result is Some(DNSName("pinning-test.badssl.com"))
DEBUG:
ServerName is: Some(DNSName("pinning-test.badssl.com"))
Try to parse the huge payload of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47048, dst_port: 443, proto: 6 }
DEBUG: We had a problem: the entry of Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47048, dst_port: 443, proto: 6 } doesn't exist
Ok
Ok


TCP Headers: tcp src_port 443 dst_port 47048 seq 3469103641 ack 374511595 data_offset 8 flags | ACK PSH |cwnd 229 csum 47111 urgent 0
Total 387

Pkt #3469103641 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47048, dst_port: 443, proto: 6 }
not client hello
not client hello
not server hello


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511595 ack 3469103915 data_offset 8 flags | ACK PSH |cwnd 303 csum 24779 urgent 0
Total 388

Pkt #374511595 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }
Packet type doesn't match a handshake, however we still need to insert this packet?

We have hit a flow but the current packet match handshake!
Suppect to be starting a new TLS handshake, we should remove the hash value and start again
Try to insert 179
Inserted
reading size of 179 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 179
Packet type doesn't match or we can't decode payload
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47048 seq 3469103915 ack 374511774 data_offset 8 flags | ACK PSH |cwnd 237 csum 42521 urgent 0
Total 389

Pkt #3469103915 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47048, dst_port: 443, proto: 6 }
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload
Packet type doesn't match or we can't decode payload


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511774 ack 3469104764 data_offset 8 flags | ACK FIN |cwnd 324 csum 35402 urgent 0
Total 390

Pkt #374511774 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 443 dst_port 47048 seq 3469104764 ack 374511775 data_offset 8 flags | ACK FIN |cwnd 237 csum 35436 urgent 0
Total 391

Pkt #3469104764 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47048, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47048 dst_port 443 seq 374511775 ack 3469104765 data_offset 8 flags | ACK |cwnd 324 csum 35298 urgent 0
Total 392

Pkt #374511775 is Occupied!
And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47048, proto: 6 }

There is nothing, that is why we should insert the packet!!!

Quack: try to insert 0

ON FRAME: Read bytes but got None
Passing because is not Client Key Exchange


TCP Headers: tcp src_port 47050 dst_port 443 seq 4225315461 ack 0 data_offset 10 flags | SYN |cwnd 29200 csum 48179 urgent 0
Total 393

Pkt #4225315461 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47050, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 443 dst_port 47050 seq 781476638 ack 4225315462 data_offset 10 flags | ACK SYN |cwnd 28160 csum 660 urgent 0
Total 394

Pkt #781476638 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47050, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47050 dst_port 443 seq 4225315462 ack 781476639 data_offset 8 flags | ACK |cwnd 229 csum 40421 urgent 0
Total 395

Pkt #4225315462 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47050, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None


TCP Headers: tcp src_port 47050 dst_port 443 seq 4225315462 ack 781476639 data_offset 8 flags | ACK PSH |cwnd 229 csum 45374 urgent 0
Total 396

Pkt #4225315462 is Vacant

And the flow is: Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47050, proto: 6 }
is client hello
ClientHello
Matching server name
DNS name is : DNSName("invalid-expected-sct.badssl.com")
DEBUG: Result is Some(DNSName("invalid-expected-sct.badssl.com"))
DEBUG:
is client hello
  1: Has allocated a new buffer:
    2: packet recv for untracked flow did not have a syn flag, skipped
reading size of 333 payload into the flow entry 
Flow { src_ip: 2886997012, dst_ip: 1754945897, src_port: 443, dst_port: 47050, proto: 6 } 
into the payload cache (hashmap)

size of the entry is: 333
      4: This packet is inserted, quack


TCP Headers: tcp src_port 443 dst_port 47050 seq 781476639 ack 4225315795 data_offset 8 flags | ACK |cwnd 229 csum 40033 urgent 0
Total 397

Pkt #781476639 is Vacant

And the flow is: Flow { src_ip: 1754945897, dst_ip: 2886997012, src_port: 47050, dst_port: 443, proto: 6 }

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None

ON FRAME: Read bytes but got None
